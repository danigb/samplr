(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(8238)}])},8238:function(e,t,a){"use strict";let s,i,n,r,l;a.r(t),a.d(t,{default:function(){return eM}});var o,c,u,d,h,p,f,m,_,P,y,g,v,b,x,M,D,w,F=a(5893),j=a(6340),A=a.n(j),k=a(9008),C=a.n(k),N=a(7294),G=(e,t,a)=>{if(!t.has(e))throw TypeError("Cannot "+a)},S=(e,t,a)=>(G(e,t,"read from private field"),a?a.call(e):t.get(e)),E=(e,t,a)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,a)},z=(e,t,a,s)=>(G(e,t,"write to private field"),s?s.call(e,a):t.set(e,a),a);function B(e){let t=e.filter(e=>!!e);return t.reduce((e,t)=>{let a="output"in e?e.output:e,s="input"in t?t.input:t;return a.connect(s),t}),()=>{t.reduce((e,t)=>{let a="output"in e?e.output:e,s="input"in t?t.input:t;return a.disconnect(s),t})}}function T(e){return void 0===e?void 0:"number"==typeof e?e:"string"==typeof e?function(e){let t=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(e),a=t[1].toUpperCase();if(!a)return;let s=t[2],i="b"===s[0]?-s.length:s.length,n=t[3]?+t[3]:4,r=(a.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][r]+i+12*(n+1)}(e):T(e.midi??e.name)}function R(e){return e*e/16129}function W(){let e=new Set;return{subscribe:function(t){return e.add(t),()=>{e.delete(t)}},trigger:function(t){e.forEach(e=>e(t))}}}var I=class{constructor(e,t){this.context=e,E(this,o,void 0),E(this,c,void 0),E(this,u,void 0),E(this,d,void 0),E(this,h,void 0),E(this,p,void 0),z(this,p,Object.freeze({destination:e.destination,volume:100,volumeToGain:R,...t})),this.input=new GainNode(this.context),z(this,o,new GainNode(this.context)),z(this,d,B([this.input,S(this,o),S(this,p).destination]));let a=function(e){let t=e,a=new Set;return{subscribe:function(e){return a.add(e),e(t),()=>{a.delete(e)}},set:function(e){t=e,a.forEach(e=>e(t))},get:function(){return t}}}(t.volume??100);this.setVolume=a.set;let s=t.volumeToGain??R;z(this,h,a.subscribe(e=>{S(this,o).gain.value=s(e)}))}addInsert(e){S(this,u)??z(this,u,[]),S(this,u).push(e),S(this,d).call(this),z(this,d,B([this.input,...S(this,u),S(this,o),S(this,p).destination]))}addSend(e,t,a){let s=new GainNode(this.context);s.gain.value=a;let i="input"in t?t.input:t,n=B([S(this,o),s,i]);S(this,c)??z(this,c,[]),S(this,c).push({name:e,mix:s,disconnect:n})}setSend(e,t){var a;let s=null==(a=S(this,c))?void 0:a.find(t=>t.name===e);s?s.mix.gain.value=t:console.warn("Send bus not found: "+e)}disconnect(){var e;S(this,d).call(this),S(this,h).call(this),null==(e=S(this,c))||e.forEach(e=>e.disconnect()),z(this,c,void 0)}};function O(e){var t,a;let s;if(null===e.buffer)return()=>void 0;let i=e.destination.context,n=i.createBufferSource();n.buffer=e.buffer,n.detune.value=(null==e?void 0:e.detune)??0;let r=e.lpfCutoffHz?new BiquadFilterNode(i,{type:"lowpass",frequency:e.lpfCutoffHz}):void 0,l=i.createGain();l.gain.value=(null==e?void 0:e.gain)??1;let[o,c]=function(e,t=.2){let a=0,s=new GainNode(e,{gain:1});return[s,function(i){if(a)return a;s.gain.cancelScheduledValues(i);let n=i||e.currentTime;return a=n+t,s.gain.setValueAtTime(1,n),s.gain.linearRampToValueAtTime(0,a),a}]}(i,e.decayTime);n.onended=(a=[B([n,r,l,o,e.destination]),null==(t=e.stop)?void 0:t.call(e,t=>{(void 0===t||void 0===t.stopId||t.stopId===e.stopId)&&d(null==t?void 0:t.time)})],s=!1,()=>{s||(s=!0,a.forEach(e=>null==e?void 0:e()))});let u=e.time||i.currentTime;function d(e){if(e??(e=i.currentTime),e<=u)n.stop(e);else{let t=c(e);n.stop(t)}}return n.start(u),void 0!==e.duration&&d(u+e.duration),d}async function U(e,t){t=t.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");let a=await fetch(t);if(200!==a.status){console.warn("Error loading buffer. Invalid status: ",a.status,t);return}try{let t=await a.arrayBuffer(),s=await e.decodeAudioData(t);return s}catch(e){console.warn("Error loading buffer",e,t)}}async function V(e,t,a){a.groups.forEach(s=>{let i=function(e,t,a=".ogg"){let s={},i=e.meta.baseUrl??"",n=e.global.default_path??"";return t?t.regions.reduce((e,t)=>(t.sample&&(e[t.sample]=`${i}/${n}${t.sample}${a}`),e),s):s}(a,s);return L(e,t,i)})}async function $(e){var t,a,s;if("string"==typeof e)return H(e);if("global"in e)return e;if("websfzUrl"in e){let i=await H(e.websfzUrl);return i.meta??(i.meta={}),(t=i.meta).name??(t.name=e.name),(a=i.meta).baseUrl??(a.baseUrl=e.baseUrl),(s=i.meta).formats??(s.formats=e.formats),i}throw Error("Invalid instrument: "+JSON.stringify(e))}async function L(e,t,a){await Promise.all(Object.keys(a).map(async s=>{if(t[s])return;let i=await U(e,a[s]);return i&&(t[s]=i),t}))}async function H(e){try{let t=await fetch(e),a=await t.json();return a}catch(t){throw console.warn(`Can't load SFZ file ${e}`,t),Error(`Can't load SFZ file ${e}`)}}function q(e,t,a){return(void 0===t||void 0!==e&&e>=t)&&(void 0===a||void 0!==e&&e<=a)}o=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap;var K=Object.freeze({meta:{},global:{},groups:[]}),J=class{constructor(e,t,a){this.context=e,E(this,f,void 0),E(this,m,void 0),E(this,_,void 0),E(this,P,void 0),E(this,y,void 0),z(this,m,{destination:a.destination??e.destination,detune:0,volume:a.volume??100,velocity:a.velocity??100,decayTime:.3}),this.buffers={},z(this,_,W()),z(this,f,K),z(this,P,$(t).then(t=>(z(this,f,Object.freeze(t)),V(e,this.buffers,S(this,f))))),z(this,y,new I(e,S(this,m))),this.output=S(this,y)}async loaded(){return await S(this,P),this}start(e){let t="object"==typeof e?e:{note:e},a=T(t.note);if(void 0===a)return()=>void 0;let s=t.velocity??S(this,m).velocity,i=function(e,t){let a=[];for(let s of e.groups)if(q(t.midi,s.lokey,s.hikey)&&q(t.velocity,s.lovel,s.hivel)&&q(t.cc64,s.locc64,s.hicc64))for(let e of s.regions)q(t.midi,e.lokey,e.hikey)&&q(t.velocity,e.lovel,e.hivel)&&q(t.cc64,s.locc64,s.hicc64)&&a.push([s,e]);return a}(S(this,f),{midi:a,velocity:s});console.log(">>>",e,i.length);let n=i.map(([e,s])=>{console.log(">>>",s,this.buffers[s.sample]);let i=s.pitch_keycenter??s.key??a,n=this.output.input;return O({buffer:this.buffers[s.sample]??null,destination:n,decayTime:t.decayTime??S(this,m).decayTime,detune:(a-i)*100+(t.detune??S(this,m).detune),gain:R(t.velocity??S(this,m).velocity),time:t.time,duration:t.duration,stop:S(this,_).subscribe,stopId:t.stopId??t.note})});return e=>n.forEach(t=>t(e))}stop(e){S(this,_).trigger("object"==typeof e?e:{stopId:e})}};f=new WeakMap,m=new WeakMap,_=new WeakMap,P=new WeakMap,y=new WeakMap;var X={RhodesMkI:{name:"RhodesMkI",websfzUrl:"https://danigb.github.io/samples/jlearman/rhodes-mki/jrhodes3dst.websfz.json"},CP80:{name:"CP80",websfzUrl:"https://danigb.github.io/samples/gs-e-pianos/CP80/cp80.websfz.json"},"Pianet T":{name:"Pianet T",websfzUrl:"https://danigb.github.io/samples/gs-e-pianos/Pianet T/pianet-t.websfz.json"},"Wurlitzer EP200":{name:"Wurlitzer EP200",websfzUrl:"https://danigb.github.io/samples/gs-e-pianos/Wurlitzer EP200/wurlitzer-ep200.websfz.json"}},Z=class extends J{constructor(e,t,a){super(e,X[t]??t,a)}},Q=["preDelay","bandwidth","inputDiffusion1","inputDiffusion2","decay","decayDiffusion1","decayDiffusion2","damping","excursionRate","excursionDepth","wet","dry"],Y=new WeakMap;async function ee(e){let t=Y.get(e);if(!t){let a=new Blob(['"use strict";(()=>{var f=class extends AudioWorkletProcessor{_pDLength;_preDelay;_pDWrite;_lp1;_lp2;_lp3;_excPhase;_taps;_Delays;sampleRate;static get parameterDescriptors(){return[["preDelay",0,0,sampleRate-1,"k-rate"],["bandwidth",.9999,0,1,"k-rate"],["inputDiffusion1",.75,0,1,"k-rate"],["inputDiffusion2",.625,0,1,"k-rate"],["decay",.5,0,1,"k-rate"],["decayDiffusion1",.7,0,.999999,"k-rate"],["decayDiffusion2",.5,0,.999999,"k-rate"],["damping",.005,0,1,"k-rate"],["excursionRate",.5,0,2,"k-rate"],["excursionDepth",.7,0,2,"k-rate"],["wet",1,0,1,"k-rate"],["dry",0,0,1,"k-rate"]].map(e=>new Object({name:e[0],defaultValue:e[1],minValue:e[2],maxValue:e[3],automationRate:e[4]}))}constructor(e){super(),this.sampleRate=sampleRate,this._Delays=[],this._pDLength=sampleRate+(128-sampleRate%128),this._preDelay=new Float32Array(this._pDLength),this._pDWrite=0,this._lp1=0,this._lp2=0,this._lp3=0,this._excPhase=0,[.004771345,.003595309,.012734787,.009307483,.022579886,.149625349,.060481839,.1249958,.030509727,.141695508,.089244313,.106280031].forEach(a=>this.makeDelay(a,sampleRate)),this._taps=Int16Array.from([.008937872,.099929438,.064278754,.067067639,.066866033,.006283391,.035818689,.011861161,.121870905,.041262054,.08981553,.070931756,.011256342,.004065724],a=>Math.round(a*sampleRate))}makeDelay(e,a){let t=Math.round(e*a),s=2**Math.ceil(Math.log2(t));this._Delays.push([new Float32Array(s),t-1,0,s-1])}writeDelay(e,a){return this._Delays[e][0][this._Delays[e][1]]=a}readDelay(e){return this._Delays[e][0][this._Delays[e][2]]}readDelayAt(e,a){let t=this._Delays[e];return t[0][t[2]+a&t[3]]}readDelayCAt(e,a){let t=this._Delays[e],s=a-~~a,d=~~a+t[2]-1,r=t[3],D=t[0][d++&r],l=t[0][d++&r],h=t[0][d++&r],y=t[0][d&r],u=(3*(l-h)-D+y)/2,m=2*h+D-(5*l+y)/2,c=(h-D)/2;return((u*s+m)*s+c)*s+l}process(e,a,t){let s=~~t.preDelay[0],d=t.bandwidth[0],r=t.inputDiffusion1[0],D=t.inputDiffusion2[0],l=t.decay[0],h=t.decayDiffusion1[0],y=t.decayDiffusion2[0],u=1-t.damping[0],m=t.excursionRate[0]/sampleRate,c=t.excursionDepth[0]*sampleRate/1e3,w=t.wet[0]*.6,A=t.dry[0];if(e[0].length==2)for(let i=127;i>=0;i--)this._preDelay[this._pDWrite+i]=(e[0][0][i]+e[0][1][i])*.5,a[0][0][i]=e[0][0][i]*A,a[0][1][i]=e[0][1][i]*A;else if(e[0].length>0){this._preDelay.set(e[0][0],this._pDWrite);for(let i=127;i>=0;i--)a[0][0][i]=a[0][1][i]=e[0][0][i]*A}else this._preDelay.set(new Float32Array(128),this._pDWrite);let o=0;for(;o<128;){let i=0,b=0;this._lp1+=d*(this._preDelay[(this._pDLength+this._pDWrite-s+o)%this._pDLength]-this._lp1);let p=this.writeDelay(0,this._lp1-r*this.readDelay(0));p=this.writeDelay(1,r*(p-this.readDelay(1))+this.readDelay(0)),p=this.writeDelay(2,r*p+this.readDelay(1)-D*this.readDelay(2)),p=this.writeDelay(3,D*(p-this.readDelay(3))+this.readDelay(2));let k=D*p+this.readDelay(3),g=c*(1+Math.cos(this._excPhase*6.28)),x=c*(1+Math.sin(this._excPhase*6.2847)),_=this.writeDelay(4,k+l*this.readDelay(11)+h*this.readDelayCAt(4,g));this.writeDelay(5,this.readDelayCAt(4,g)-h*_),this._lp2+=u*(this.readDelay(5)-this._lp2),_=this.writeDelay(6,l*this._lp2-y*this.readDelay(6)),this.writeDelay(7,this.readDelay(6)+y*_),_=this.writeDelay(8,k+l*this.readDelay(7)+h*this.readDelayCAt(8,x)),this.writeDelay(9,this.readDelayCAt(8,x)-h*_),this._lp3+=u*(this.readDelay(9)-this._lp3),_=this.writeDelay(10,l*this._lp3-y*this.readDelay(10)),this.writeDelay(11,this.readDelay(10)+y*_),i=this.readDelayAt(9,this._taps[0])+this.readDelayAt(9,this._taps[1])-this.readDelayAt(10,this._taps[2])+this.readDelayAt(11,this._taps[3])-this.readDelayAt(5,this._taps[4])-this.readDelayAt(6,this._taps[5])-this.readDelayAt(7,this._taps[6]),b=this.readDelayAt(5,this._taps[7])+this.readDelayAt(5,this._taps[8])-this.readDelayAt(6,this._taps[9])+this.readDelayAt(7,this._taps[10])-this.readDelayAt(9,this._taps[11])-this.readDelayAt(10,this._taps[12])-this.readDelayAt(11,this._taps[13]),a[0][0][o]+=i*w,a[0][1][o]+=b*w,this._excPhase+=m,o++;for(let R=0,n=this._Delays[0];R<this._Delays.length;n=this._Delays[++R])n[1]=n[1]+1&n[3],n[2]=n[2]+1&n[3]}return this._pDWrite=(this._pDWrite+128)%this._pDLength,!0}};registerProcessor("DattorroReverb",f);})();'],{type:"application/javascript"}),s=URL.createObjectURL(a);t=e.audioWorklet.addModule(s),Y.set(e,t)}await t;let a=new AudioWorkletNode(e,"DattorroReverb",{outputChannelCount:[2]});return a}var et=class{constructor(e){E(this,g,void 0),E(this,v,void 0),E(this,b,void 0),this.input=e.createGain(),z(this,b,e.destination),z(this,v,ee(e).then(e=>(this.input.connect(e),e.connect(S(this,b)),z(this,g,e),this)))}get paramNames(){return Q}getParam(e){var t;return null==(t=S(this,g))?void 0:t.parameters.get("preDelay")}get isReady(){return void 0!==S(this,g)}ready(){return S(this,v)}connect(e){S(this,g)&&(S(this,g).disconnect(S(this,b)),S(this,g).connect(e)),z(this,b,e)}};g=new WeakMap,v=new WeakMap,b=new WeakMap;var ea=class{constructor(e,t){var a;this.context=e,E(this,x,void 0),E(this,M,void 0),E(this,D,void 0),E(this,w,void 0),z(this,x,{destination:t.destination??e.destination,detune:0,volume:t.volume??100,velocity:t.velocity??100,buffers:t.buffers??{},volumeToGain:t.volumeToGain??R,noteToSample:t.noteToSample??(e=>[e.note.toString(),0])}),this.buffers={},z(this,M,W());let s="function"==typeof S(this,x).buffers?S(this,x).buffers:(a=S(this,x).buffers,async(e,t)=>{await Promise.all([Object.keys(a).map(async s=>{let i=a[s];if(i instanceof AudioBuffer)t[s]=i;else if("string"==typeof i){let a=await U(e,i);a&&(t[s]=a)}})])});z(this,D,s(e,this.buffers)),z(this,w,new I(e,S(this,x))),this.output=S(this,w)}async loaded(){return await S(this,D),this}start(e){let t="object"==typeof e?e:{note:e},[a,s]=S(this,x).noteToSample(t,this.buffers,S(this,x)),i=this.buffers[a]??null;return O({buffer:i,destination:S(this,w).input,time:t.time,duration:t.duration,decayTime:t.decayTime,lpfCutoffHz:t.lpfCutoffHz,detune:s+(t.detune??S(this,x).detune),gain:S(this,x).volumeToGain(t.velocity??S(this,x).velocity),stop:S(this,M).subscribe,stopId:t.stopId??t.note})}stop(e){S(this,M).trigger("object"==typeof e?e:{stopId:e})}};x=new WeakMap,M=new WeakMap,D=new WeakMap,w=new WeakMap;var es=class extends ea{constructor(e,t){var a;let s=void 0===(a=t.library)?(e,t)=>ei("MusyngKite",e,t??"ogg"):"function"==typeof a?a:a.url,i=s(t.instrument,t.format);super(e,{destination:t.destination,detune:t.detune,volume:t.volume,velocity:t.velocity,decayTime:t.decayTime??.5,lpfCutoffHz:t.lpfCutoffHz,buffers:async(e,t)=>{let a=await (await fetch(i)).text(),s=function(e){let t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");let a=e.indexOf("=",t)+2,s=e.lastIndexOf(",");return JSON.parse(e.slice(a,s)+"}")}(a),n=Object.keys(s);await Promise.all(n.map(async a=>{var i;let n=T(a);if(!n)return;let r=function(e){let t=window.atob(e),a=t.length,s=new Uint8Array(a);for(let e=0;e<a;e++)s[e]=t.charCodeAt(e);return s.buffer}((i=s[a]).slice(i.indexOf(",")+1)),l=await e.decodeAudioData(r);t[n]=l}))},noteToSample:(e,t,a)=>{let s=T(e.note);return void 0===s?["",0]:function(e,t){let a=0;for(;void 0===t[e+a]&&a<128;)a=a>0?-a:-a+1;return 127===a?[e,0]:[e+a,-(100*a)]}(s,t)}});let n=t.extraGain??5,r=new GainNode(e,{gain:n});this.output.addInsert(r)}};function ei(e,t,a){return`https://gleitz.github.io/midi-js-soundfonts/${e}/${t}-${a}.js`}var en={FluidR3:{name:"FluidR3_GM",url:(e,t="mp3")=>ei("FluidR3_GM",e,t),instruments:["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","percussion","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"]},MusyngKite:{name:"MusyngKite",url:(e,t="mp3")=>ei("MusyngKite",e,t),instruments:["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"]}},er=class extends ea{constructor(e,t){var a,s;super(e,{destination:t.destination,detune:t.detune,volume:t.volume,velocity:t.velocity,decayTime:t.decayTime??.5,lpfCutoffHz:t.lpfCutoffHz,buffers:(a=t.baseUrl??"https://danigb.github.io/samples/splendid-grand-piano",s=t.format??"ogg",async(e,t)=>{for(let i of el)await Promise.all(i.samples.map(async([n,r])=>{let l=`${a}/${r}.${s}`,o=await U(e,l);o&&(t[i.name+n]=o)}))}),noteToSample:(e,t,a)=>{if("string"==typeof e.note)return[e.note,0];let s=e.velocity??a.velocity,i=el.findIndex(e=>s>=e.vel_range[0]&&s<=e.vel_range[1]),n=el[i];return n?function(e,t,a){let s=0;for(;void 0===a[e+(t+s)]&&s<128;)s=s>0?-s:-s+1;return 127===s?[e+t,0]:[e+(t+s),-(100*s)]}(n.name,e.note,t):["",0]}})}},el=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}];function eo(){return null!=s||(s=new AudioContext),s}var ec=a(2209);function eu(e){let{instrument:t}=e,a=(0,N.useRef)(null),[s,i]=(0,N.useState)([]),[n,r]=(0,N.useState)(""),[l,o]=(0,N.useState)(),[c,u]=(0,N.useState)("");return(0,N.useEffect)(()=>{ec.u5.enable().then(()=>{let e=ec.u5.inputs.map(e=>e.name);i(e),r(e[0])})},[]),a.current=null!=t?t:null,(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("button",{className:"px-1 rounded "+(l?"bg-emerald-600":"bg-zinc-700"),onClick:()=>{if(l){o(void 0),l.forEach(e=>e.remove());return}let e=ec.u5.inputs.find(e=>e.name===n);if(!e)return;let t=e.addListener("noteon",e=>{var t;let s={note:e.note.number,velocity:e.rawVelocity};null===(t=a.current)||void 0===t||t.start(s),u("".concat(s.note," (").concat(s.velocity,")"))}),s=e.addListener("noteoff",e=>{var t;null===(t=a.current)||void 0===t||t.stop({stopId:e.note.number}),u("")});o([...Array.isArray(t)?t:[t],...Array.isArray(s)?s:[s]])},children:"MIDI"}),(0,F.jsx)("select",{className:"bg-zinc-700 rounded py-[2px]",value:n,onChange:e=>{let t=e.target.value;r(t)},children:s.map(e=>(0,F.jsx)("option",{value:e,children:e},e))}),(0,F.jsx)("div",{className:"opacity-50",children:c})]})}var ed=a(5950);let eh=e=>[0,1,2,3,4,5,6,7,8,9,10,11].map(t=>t+e),ep=e=>[1,3,6,8,10].includes(e%12);function ef(e){let{className:t,borderColor:a="border-blue-700",onPress:s,onRelease:i}=e,[n,r]=(0,N.useState)(100),[l,o]=(0,N.useState)(60),[c,u]=(0,N.useState)(!1),d=e=>!1;return(0,F.jsxs)("div",{className:t,children:[(0,F.jsx)("div",{className:"piano-container border-t-8 ".concat(a),children:[...eh(l),...eh(l+12)].map(e=>ep(e)?(0,F.jsx)("div",{className:"accidental-key__wrapper",children:(0,F.jsx)("button",{className:"accidental-key ".concat(d(e)?"accidental-key--playing":""),onMouseDown:()=>s({note:e,velocity:n}),onMouseUp:()=>{!c&&i&&i(e)},children:(0,F.jsx)("div",{className:"text"})})},e):(0,F.jsx)("button",{className:"natural-key ".concat(d(e)?"natural-key--playing":""),onMouseDown:()=>s({note:e,velocity:n}),onMouseUp:()=>{!c&&i&&i(e)},children:(0,F.jsx)("div",{className:"text"})},e))}),(0,F.jsxs)("div",{className:"flex gap-1 items-center mt-1",children:[(0,F.jsxs)("div",{children:["Octave: ",l,"-",l+12+11]}),(0,F.jsx)("button",{className:"bg-zinc-900 px-1 rounded",onClick:()=>{o(l-12)},children:"-"}),(0,F.jsx)("button",{className:"bg-zinc-900 px-1 rounded",onClick:()=>{o(l+12)},children:"+"}),(0,F.jsxs)("div",{className:"ml-3",children:["Velocity: ",n]}),(0,F.jsx)("input",{type:"range",min:0,max:127,value:n,onChange:e=>r(e.target.valueAsNumber)}),(0,F.jsx)("input",{className:"ml-3",type:"checkbox",checked:c,onChange:e=>u(e.target.checked)}),(0,F.jsx)("div",{className:"",children:"Sustain"}),(0,F.jsx)("button",{className:"bg-zinc-900 px-1 rounded",onClick:()=>{let e=ed.Ci.degrees("C4 major"),t=ed.e6.numeric([1,8,1]).map(e).map(ed.jC.midi);t.map((e,t)=>s({note:null!=e?e:0,velocity:Math.floor(60+40*Math.random()),time:.25*t,duration:.05}))},children:"Test"})]})]})}function em(){return(0,N.useState)("init")}function e_(e){let{status:t,onClick:a}=e;return"init"===t?(0,F.jsx)("button",{className:"text-rose-700 bg-zinc-900 px-2 rounded",onClick:a,children:"Load"}):"ready"===t?(0,F.jsx)("div",{className:"text-teal-600",children:"Ready"}):"loading"===t?(0,F.jsx)("div",{className:"text-gray-500",children:"Loading..."}):(0,F.jsx)("div",{className:"text-red-700",children:"Error loading"})}function eP(e){let{className:t}=e,[a,s]=(0,N.useState)(void 0),[n,r]=em(),[l,o]=(0,N.useState)(0),[c,u]=(0,N.useState)(100);return(0,F.jsxs)("div",{className:t,children:[(0,F.jsxs)("div",{className:"flex gap-2 items-end mb-2",children:[(0,F.jsx)("h1",{className:"text-3xl",children:"Electric Piano"}),(0,F.jsx)(e_,{status:n,onClick:function(){if(a)return;r("loading");let e=eo();null!=i||(i=new et(e));let t=new Z(e,"CP80",{volume:c});t.output.addSend("reverb",i,l),s(t),t.loaded().then(()=>{r("ready")})}}),(0,F.jsx)(eu,{instrument:a})]}),(0,F.jsx)("div",{}),(0,F.jsxs)("div",{className:"ready"!==n?"opacity-30":"",children:[(0,F.jsx)("div",{className:"flex gap-4 mb-2 no-select",children:(0,F.jsx)("button",{className:"bg-zinc-700 rounded px-3 py-0.5 shadow",onClick:()=>{null==a||a.stop()},children:"Stop all"})}),(0,F.jsxs)("div",{className:"flex gap-4 mb-2 no-select",children:[(0,F.jsx)("div",{children:"Volume:"}),(0,F.jsx)("input",{type:"range",min:0,max:128,step:1,value:c,onChange:e=>{let t=e.target.valueAsNumber;null==a||a.output.setVolume(t),u(t)}}),(0,F.jsx)("div",{children:"Reverb:"}),(0,F.jsx)("input",{type:"range",min:0,max:1,step:.001,value:l,onChange:e=>{let t=e.target.valueAsNumber;null==a||a.output.setSend("reverb",t),o(t)}})]}),(0,F.jsx)(ef,{borderColor:"border-rose-700",onPress:e=>{var t;a&&(e.time=(null!==(t=e.time)&&void 0!==t?t:0)+a.context.currentTime,a.start(e))},onRelease:e=>{null==a||a.stop({stopId:e})}})]})]})}let ey=["crash","hhclosed-1","hhclosed-2","hhopen-1","hhopen-2","kick","ride","snare-1","snare-2","snare-3","tom-high","tom-low","tom-mid"];function eg(e){let{className:t}=e,[a,s]=em(),[i,r]=(0,N.useState)(),[l,o]=(0,N.useState)(0),[c,u]=(0,N.useState)(100);return(0,F.jsxs)("div",{className:t,children:[(0,F.jsxs)("div",{className:"flex gap-2 items-end mb-2",children:[(0,F.jsx)("h1",{className:"text-3xl",children:"Sampler"}),(0,F.jsx)(e_,{status:a,onClick:()=>{!function(){s("loading");let e=eo();null!=n||(n=new et(e));let t=ey.reduce((e,t)=>(e[t]="https://danigb.github.io/samples/drum-machines/808-mini/".concat(t,".m4a"),e),{}),a=new ea(e,{buffers:t});a.output.addSend("reverb",n,l),a.loaded().then(()=>{s("ready"),r(a)}).catch(e=>{s("error"),console.log("Instrument error",e)})}()}})]}),(0,F.jsxs)("div",{className:"ready"!==a?"opacity-30 no-select":"no-select",children:[(0,F.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,F.jsx)("div",{children:"Vol:"}),(0,F.jsx)("input",{type:"range",min:0,max:127,step:1,value:c,onChange:e=>{let t=e.target.valueAsNumber;null==i||i.output.setVolume(t),u(t)}}),(0,F.jsx)("div",{children:"Reverb:"}),(0,F.jsx)("input",{type:"range",min:0,max:1,step:.001,value:l,onChange:e=>{let t=e.target.valueAsNumber;null==i||i.output.setSend("reverb",t),o(t)}})]}),(0,F.jsx)("div",{className:"flex flex-wrap gap-2",children:ey.map(e=>(0,F.jsx)("div",{className:"bg-zinc-700 rounded px-2",children:(0,F.jsx)("div",{className:"flex",children:(0,F.jsx)("button",{className:"text-left flex-grow",onClick:()=>{null==i||i.start({note:e})},children:e})})},e))})]})]})}let ev=Object.keys(en);function eb(e){let{className:t}=e,[a,s]=em(),[i,n]=(0,N.useState)(ev[1]),[l,o]=(0,N.useState)("marimba"),[c,u]=(0,N.useState)(void 0),[d,h]=(0,N.useState)(0),[p,f]=(0,N.useState)(100),m=en[i];function _(e,t){let a=en[e],i=eo();null!=r||(r=new et(i));let n=new es(i,{instrument:t,library:a});n.output.addSend("reverb",r,0),n.loaded().then(()=>{s("ready"),u(n)}).catch(e=>{s("error"),console.log("Instrument error",e)})}return(0,F.jsxs)("div",{className:t,children:[(0,F.jsxs)("div",{className:"flex gap-2 items-end mb-2",children:[(0,F.jsx)("h1",{className:"text-3xl",children:"Soundfont"}),(0,F.jsx)(e_,{status:a,onClick:()=>{_(i,l)}}),(0,F.jsx)(eu,{instrument:c})]}),(0,F.jsxs)("div",{className:"ready"!==a?"opacity-30 no-select":"no-select",children:[(0,F.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,F.jsx)("select",{className:"bg-zinc-700 rounded",value:i,onChange:e=>{let t=e.target.value;_(t,l),n(t)},children:ev.map(e=>(0,F.jsx)("option",{value:e,children:e},e))}),(0,F.jsx)("select",{className:"bg-zinc-700 rounded",value:l,onChange:e=>{let t=e.target.value;_(i,t),o(t)},children:m.instruments.map(e=>(0,F.jsx)("option",{value:e,children:e},e))}),(0,F.jsx)("button",{className:"bg-zinc-700 rounded px-3 py-0.5 shadow",onClick:()=>{null==c||c.stop()},children:"Stop all"})]}),(0,F.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,F.jsx)("div",{children:"Volume:"}),(0,F.jsx)("input",{type:"range",min:0,max:127,step:1,value:p,onChange:e=>{let t=e.target.valueAsNumber;null==c||c.output.setVolume(t),f(t)}}),(0,F.jsx)("div",{children:"Reverb:"}),(0,F.jsx)("input",{type:"range",min:0,max:1,step:.001,value:d,onChange:e=>{let t=e.target.valueAsNumber;null==c||c.output.setSend("reverb",t),h(t)}})]}),(0,F.jsx)(ef,{borderColor:"border-teal-600",onPress:e=>{var t;c&&(e.time=(null!==(t=e.time)&&void 0!==t?t:0)+c.context.currentTime,c.start(e))},onRelease:e=>{null==c||c.stop({stopId:""+e})}})]})]})}function ex(e){let{className:t}=e,[a,s]=(0,N.useState)(void 0),[i,n]=em(),[r,o]=(0,N.useState)(0),[c,u]=(0,N.useState)(100);return(0,F.jsxs)("div",{className:t,children:[(0,F.jsxs)("div",{className:"flex gap-2 items-end mb-2",children:[(0,F.jsx)("h1",{className:"text-3xl",children:"Piano"}),(0,F.jsx)(e_,{status:i,onClick:function(){if(a)return;n("loading");let e=eo();null!=l||(l=new et(e));let t=new er(e,{volume:c});t.output.addSend("reverb",l,r),s(t),t.loaded().then(()=>{n("ready")})}}),(0,F.jsx)(eu,{instrument:a})]}),(0,F.jsx)("div",{}),(0,F.jsxs)("div",{className:"ready"!==i?"opacity-30":"",children:[(0,F.jsx)("div",{className:"flex gap-4 mb-2 no-select",children:(0,F.jsx)("button",{className:"bg-zinc-700 rounded px-3 py-0.5 shadow",onClick:()=>{null==a||a.stop()},children:"Stop all"})}),(0,F.jsxs)("div",{className:"flex gap-4 mb-2 no-select",children:[(0,F.jsx)("div",{children:"Volume:"}),(0,F.jsx)("input",{type:"range",min:0,max:128,step:1,value:c,onChange:e=>{let t=e.target.valueAsNumber;null==a||a.output.setVolume(t),u(t)}}),(0,F.jsx)("div",{children:"Reverb:"}),(0,F.jsx)("input",{type:"range",min:0,max:1,step:.001,value:r,onChange:e=>{let t=e.target.valueAsNumber;null==a||a.output.setSend("reverb",t),o(t)}})]}),(0,F.jsx)(ef,{borderColor:"border-rose-700",onPress:e=>{var t;a&&(e.time=(null!==(t=e.time)&&void 0!==t?t:0)+a.context.currentTime,a.start(e))},onRelease:e=>{null==a||a.stop({stopId:e})}})]})]})}function eM(){return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(C(),{children:[(0,F.jsx)("title",{children:"smplr"}),(0,F.jsx)("meta",{name:"description",content:"Plug and play web instruments"}),(0,F.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,F.jsxs)("main",{className:"max-w-4xl mx-auto my-20 p-4"+A().className,children:[(0,F.jsxs)("div",{className:"flex items-end mb-16",children:[(0,F.jsx)("h1",{className:"text-6xl font-bold",children:"smplr"}),(0,F.jsx)("div",{children:"0.2.0"})]}),(0,F.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,F.jsx)(eg,{}),(0,F.jsx)(ex,{}),(0,F.jsx)(eb,{}),(0,F.jsx)(eP,{})]})]})]})}}},function(e){e.O(0,[643,907,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);