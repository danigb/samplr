"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{1513:function(t,e,n){let i;function s(){return null!=i||(i=new AudioContext),i}n.d(e,{k:function(){return s}})},744:function(t,e,n){n.d(e,{Be:function(){return t2},Dc:function(){return tL},Dy:function(){return t1},E8:function(){return tX},Jp:function(){return tW},No:function(){return tf},TU:function(){return tJ},Z4:function(){return tK},Zx:function(){return tH},a0:function(){return tV},ab:function(){return t5},co:function(){return tZ},mK:function(){return tc},mb:function(){return t_},o6:function(){return tO},wz:function(){return tj},xA:function(){return tu},xU:function(){return tb},zP:function(){return t0}});var i,s,r,o,a,l,u,h,p,c,d,f,m,y,P,g,v,_,M,b,D,w,F,A,k,S,I,E,C,G,B,N,T=Object.defineProperty,x=Object.defineProperties,R=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,W=(t,e,n)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,z=(t,e)=>{for(var n in e||(e={}))L.call(e,n)&&W(t,n,e[n]);if(O)for(var n of O(e))j.call(e,n)&&W(t,n,e[n]);return t},U=(t,e)=>x(t,R(e)),H=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},V=(t,e,n)=>(H(t,e,"read from private field"),n?n.call(t):e.get(t)),$=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},q=(t,e,n,i)=>(H(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),X=(t,e,n)=>(H(t,e,"access private method"),n),K=(t,e,n)=>new Promise((i,s)=>{var r=t=>{try{a(n.next(t))}catch(t){s(t)}},o=t=>{try{a(n.throw(t))}catch(t){s(t)}},a=t=>t.done?i(t.value):Promise.resolve(t.value).then(r,o);a((n=n.apply(t,e)).next())});function Z(t){let e=t.filter(t=>!!t);return e.reduce((t,e)=>{let n="output"in t?t.output:t,i="input"in e?e.input:e;return n.connect(i),e}),()=>{e.reduce((t,e)=>{let n="output"in t?t.output:t,i="input"in e?e.input:e;return n.disconnect(i),e})}}function J(t){let e=t,n=new Set;return{subscribe:function(t){return n.add(t),t(e),()=>{n.delete(t)}},set:function(t){e=t,n.forEach(t=>t(e))},get:function(){return e}}}function Y(t){return t*t/16129}var Q=class{constructor(t,e){var n,h,p;this.context=t,$(this,i,void 0),$(this,s,void 0),$(this,r,void 0),$(this,o,void 0),$(this,a,void 0),$(this,l,void 0),$(this,u,!1),q(this,l,{destination:null!=(n=null==e?void 0:e.destination)?n:t.destination,volume:null!=(h=null==e?void 0:e.volume)?h:100,volumeToGain:null!=(p=null==e?void 0:e.volumeToGain)?p:Y}),this.input=t.createGain(),q(this,i,t.createGain()),q(this,o,Z([this.input,V(this,i),V(this,l).destination]));let c=J(V(this,l).volume);this.setVolume=c.set,q(this,a,c.subscribe(t=>{V(this,i).gain.value=V(this,l).volumeToGain(t)}))}addInsert(t){if(V(this,u))throw Error("Can't add insert to disconnected channel");null!=V(this,r)||q(this,r,[]),V(this,r).push(t),V(this,o).call(this),q(this,o,Z([this.input,...V(this,r),V(this,i),V(this,l).destination]))}addEffect(t,e,n){if(V(this,u))throw Error("Can't add effect to disconnected channel");let r=this.context.createGain();r.gain.value=n;let o="input"in e?e.input:e,a=Z([V(this,i),r,o]);null!=V(this,s)||q(this,s,[]),V(this,s).push({name:t,mix:r,disconnect:a})}sendEffect(t,e){var n;if(V(this,u))throw Error("Can't send effect to disconnected channel");let i=null==(n=V(this,s))?void 0:n.find(e=>e.name===t);i?i.mix.gain.value=e:console.warn("Send bus not found: "+t)}disconnect(){var t;V(this,u)||(q(this,u,!0),V(this,o).call(this),V(this,a).call(this),null==(t=V(this,s))||t.forEach(t=>t.disconnect()),q(this,s,void 0))}};i=new WeakMap,s=new WeakMap,r=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,u=new WeakMap;var tt=class{constructor(t){this.compare=t,$(this,h,[])}push(t){let e=V(this,h).length,n=0,i=e-1,s=e;for(;n<=i;){let e=Math.floor((n+i)/2);0>this.compare(t,V(this,h)[e])?(s=e,i=e-1):n=e+1}V(this,h).splice(s,0,t)}pop(){return V(this,h).shift()}peek(){return V(this,h)[0]}removeAll(t){let e=V(this,h).length;return q(this,h,V(this,h).filter(e=>!t(e))),V(this,h).length!==e}clear(){q(this,h,[])}size(){return V(this,h).length}};function te(t,e){return t&&e?n=>{t(n),e(n)}:null!=t?t:e}h=new WeakMap;var tn=class{constructor(t,e={}){$(this,p,void 0),$(this,c,void 0),$(this,d,void 0),q(this,p,function(t){var e,n;let i={scheduleLookaheadMs:null!=(e=t.scheduleLookaheadMs)?e:200,scheduleIntervalMs:null!=(n=t.scheduleIntervalMs)?n:50,onStart:t.onStart,onEnded:t.onEnded};if(i.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(i.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(i.scheduleLookaheadMs<i.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return i}(e)),q(this,c,new tt((t,e)=>t.time-e.time)),this.player=t}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return void 0!==V(this,d)}start(t){var e;let n=this.player.context,i=n.currentTime,s=null!=(e=t.time)?e:i,r=V(this,p).scheduleLookaheadMs/1e3;return(t.onStart=te(t.onStart,V(this,p).onStart),t.onEnded=te(t.onEnded,V(this,p).onEnded),s<i+r)?this.player.start(t):(V(this,c).push(U(z({},t),{time:s})),V(this,d)||q(this,d,setInterval(()=>{let t=n.currentTime+r;for(;V(this,c).size()&&V(this,c).peek().time<=t;){let t=V(this,c).pop();t&&this.player.start(t)}V(this,c).size()||(clearInterval(V(this,d)),q(this,d,void 0))},V(this,p).scheduleIntervalMs)),e=>{(!e||e<s)&&V(this,c).removeAll(e=>e===t)||this.player.stop(U(z({},t),{time:e}))})}stop(t){var e;if(this.player.stop(t),!t){V(this,c).clear();return}let n=null!=(e=null==t?void 0:t.time)?e:0,i=null==t?void 0:t.stopId;i?V(this,c).removeAll(t=>t.time>=n&&t.stopId?t.stopId===i:t.note===i):V(this,c).removeAll(t=>t.time>=n)}disconnect(){this.player.disconnect()}};p=new WeakMap,c=new WeakMap,d=new WeakMap;var ti=class{constructor(t,e){var n,i;this.context=t,this.options=e,$(this,f,void 0),$(this,m,!1),$(this,y,void 0),q(this,f,{velocityToGain:null!=(n=e.velocityToGain)?n:Y,destination:null!=(i=e.destination)?i:t.destination}),this.buffers={},q(this,y,function(){let t=new Set;return{subscribe:function(e){return t.add(e),()=>{t.delete(e)}},trigger:function(e){t.forEach(t=>t(e))}}}())}start(t){var e,n,i,s,r,o,a,l,u,h,p,c,d,P,g;let v;if(V(this,m))throw Error("Can't start a sample on disconnected player");let _=this.context,M=t.name&&this.buffers[t.name]||this.buffers[t.note];if(!M)return console.warn(`Sample not found: '${t.note}'`),()=>void 0;let b=_.createBufferSource();b.buffer=M;let D=null!=(n=null!=(e=t.detune)?e:this.options.detune)?n:0;b.detune?b.detune.value=D:b.playbackRate&&(b.playbackRate.value=Math.pow(2,D/1200));let w=null!=(i=t.lpfCutoffHz)?i:this.options.lpfCutoffHz,F=w?_.createBiquadFilter():void 0;w&&F&&(F.type="lowpass",F.frequency.value=w);let A=_.createGain(),k=null!=(r=null!=(s=t.velocity)?s:this.options.velocity)?r:100;A.gain.value=V(this,f).velocityToGain(k),(null!=(o=t.loop)?o:this.options.loop)&&(b.loop=!0,b.loopStart=null!=(a=t.loopStart)?a:0,b.loopEnd=null!=(l=t.loopEnd)?l:M.duration);let[S,I]=function(t,e=.2){let n=0,i=t.createGain();return i.gain.value=1,[i,function(s){if(n)return n;i.gain.cancelScheduledValues(s);let r=s||t.currentTime;return n=r+e,i.gain.setValueAtTime(1,r),i.gain.linearRampToValueAtTime(0,n),n}]}(_,null!=(u=t.decayTime)?u:this.options.decayTime);function E(t){if(null!=t||(t=_.currentTime),t<=N)b.stop(t);else{let e=I(t);b.stop(e)}}let C=t.gainOffset?_.createGain():void 0;C&&t.gainOffset&&(C.gain.value=t.gainOffset);let G=null!=(h=t.stopId)?h:t.note,B=(g=[Z([b,F,A,S,C,V(this,f).destination]),null==(p=t.stop)?void 0:p.call(t,E),V(this,y).subscribe(t=>{t&&void 0!==t.stopId&&t.stopId!==G||E(null==t?void 0:t.time)})],v=!1,()=>{v||(v=!0,g.forEach(t=>null==t?void 0:t()))});b.onended=()=>{var e;B(),null==(e=t.onEnded)||e.call(t,t)},null==(c=t.onStart)||c.call(t,t);let N=Math.max(null!=(d=t.time)?d:0,_.currentTime);b.start(t.time);let T=null!=(P=t.duration)?P:M.duration;return"number"==typeof t.duration&&E(N+T),E}stop(t){V(this,y).trigger(t)}disconnect(){V(this,m)||(q(this,m,!0),this.stop(),Object.keys(this.buffers).forEach(t=>{delete this.buffers[t]}))}get connected(){return!V(this,m)}};f=new WeakMap,m=new WeakMap,y=new WeakMap;var ts=class{constructor(t,e){this.context=t;let n=new Q(t,e);this.player=new tn(new ti(t,U(z({},e),{destination:n.input})),e),this.output=n}get buffers(){return this.player.buffers}start(t){return this.player.start(t)}stop(t){this.player.stop("object"==typeof t?t:void 0!==t?{stopId:t}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function tr(t,e,n){return K(this,null,function*(){e=e.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");let i=yield n.fetch(e);if(200!==i.status){console.warn("Error loading buffer. Invalid status: ",i.status,e);return}try{let e=yield i.arrayBuffer();return yield t.decodeAudioData(e)}catch(t){console.warn("Error loading buffer",t,e)}})}function to(t){if("undefined"==typeof document)return null;let e=document.createElement("audio");for(let n=0;n<t.length;n++){let i=t[n],s=e.canPlayType(`audio/${i}`);if("probably"===s||"maybe"===s)return i;if("m4a"===i){let t=e.canPlayType("audio/aac");if("probably"===t||"maybe"===t)return i}}return null}function ta(){var t;return"."+(null!=(t=to(["ogg","m4a"]))?t:"ogg")}var tl={fetch:t=>fetch(t)},tu=class{constructor(t="smplr"){$(this,g),$(this,_),$(this,P,void 0),"undefined"!=typeof window&&"caches"in window?q(this,P,caches.open(t)):q(this,P,Promise.reject("CacheStorage not supported"))}fetch(t){return K(this,null,function*(){let e=new Request(t);try{return yield X(this,g,v).call(this,e)}catch(n){let t=yield fetch(e);return yield X(this,_,M).call(this,e,t),t}})}};function th(t){return"object"==typeof t&&"string"==typeof t.baseUrl&&"string"==typeof t.name&&Array.isArray(t.samples)&&Array.isArray(t.sampleNames)&&"object"==typeof t.nameToSample&&"object"==typeof t.sampleNameVariations}P=new WeakMap,g=new WeakSet,v=function(t){return K(this,null,function*(){let e=yield V(this,P),n=yield e.match(t);if(n)return n;throw Error("Not found")})},_=new WeakSet,M=function(t,e){return K(this,null,function*(){try{let n=yield V(this,P);yield n.put(t,e.clone())}catch(t){}})};var tp={baseUrl:"",name:"",samples:[],sampleNames:[],nameToSample:{},sampleNameVariations:{}};function tc(){return Object.keys(td)}var td={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"},tf=class{constructor(t,e){$(this,b,tp);let n=function(t){var e,n,i;let s={instrument:null!=(e=null==t?void 0:t.instrument)?e:"TR-808",storage:null!=(n=null==t?void 0:t.storage)?n:tl,url:null!=(i=null==t?void 0:t.url)?i:""};if("string"==typeof s.instrument){if(s.url||(s.url=td[s.instrument]),!s.url)throw Error("Invalid instrument: "+s.instrument)}else if(!th(s.instrument))throw Error("Invalid instrument: "+s.instrument);return s}(e),i=th(n.instrument)?Promise.resolve(n.instrument):function(t,e){return K(this,null,function*(){var n,i;let s=yield e.fetch(t),r=yield s.json();for(let e of(r.baseUrl=t.replace("/dm.json",""),r.sampleNames=[],r.nameToSample={},r.sampleNameVariations={},r.samples)){let t=-1!==e.indexOf("/")?e:e.replace("-","/");r.nameToSample[t]=t;let[s,o]=t.split("/");r.sampleNames.includes(s)||r.sampleNames.push(s),null!=(n=r.nameToSample)[s]||(n[s]=t),null!=(i=r.sampleNameVariations)[s]||(i[s]=[]),o&&r.sampleNameVariations[s].push(`${s}/${o}`)}return r})}(n.url,n.storage);this.player=new ts(t,e),this.output=this.player.output,this.load=(function(t,e,n,i){var s;let r=null!=(s=to(["ogg","m4a"]))?s:"ogg";return n.then(n=>Promise.all(n.samples.map(s=>K(this,null,function*(){let o=`${n.baseUrl}/${s}.${r}`,a=-1!==s.indexOf("/")?s:s.replace("-","/"),l=yield tr(t,o,i);l&&(e[a]=l)}))))})(t,this.player.buffers,i,n.storage).then(()=>this),i.then(t=>{q(this,b,t)})}loaded(){return K(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return V(this,b).sampleNames}getVariations(t){var e;return null!=(e=V(this,b).sampleNameVariations[t])?e:[]}start(t){var e;let n=V(this,b).nameToSample[t.note];return this.player.start(U(z({},t),{note:n||t.note,stopId:null!=(e=t.stopId)?e:t.note}))}stop(t){return this.player.stop(t)}};function tm(t){return void 0===t?void 0:"number"==typeof t?t:function(t){let e=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(t);if(!e)return;let n=e[1].toUpperCase();if(!n)return;let i=e[2],s="b"===i[0]?-i.length:i.length,r=e[3]?+e[3]:4;return[0,2,4,5,7,9,11][(n.charCodeAt(0)+3)%7]+s+12*(r+1)}(t)}function ty(t,e){return K(this,null,function*(){try{let e=yield fetch(t);return yield e.json()}catch(e){throw console.warn(`Can't load SFZ file ${t}`,e),Error(`Can't load SFZ file ${t}`)}})}function tP(t,e,n){return(void 0===e||void 0!==t&&t>=e)&&(void 0===n||void 0!==t&&t<=n)}b=new WeakMap;var tg=Object.freeze({meta:{},global:{},groups:[]}),tv=class{constructor(t,e){this.context=t,$(this,w),$(this,D,void 0),this.options=Object.freeze(Object.assign({volume:100,velocity:100,storage:tl,detune:0,destination:t.destination},e)),this.player=new ts(t,e),q(this,D,tg),this.load=(function(t,e){return K(this,null,function*(){if("string"==typeof t)return ty(t,e);if("global"in t)return t;if("websfzUrl"in t){let n=yield ty(t.websfzUrl,e);return null!=n.meta||(n.meta={}),t.name&&(n.meta.name=t.name),t.baseUrl&&(n.meta.baseUrl=t.baseUrl),t.formats&&(n.meta.formats=t.formats),n}throw Error("Invalid instrument: "+JSON.stringify(t))})})(e.instrument,this.options.storage).then(e=>(q(this,D,Object.freeze(e)),function(t,e,n,i){return K(this,null,function*(){n.groups.forEach(s=>(function(t,e,n,i){return K(this,null,function*(){yield Promise.all(Object.keys(n).map(s=>K(this,null,function*(){if(e[s])return;let r=yield tr(t,n[s],i);return r&&(e[s]=r),e})))})})(t,e,function(t,e){var n,i,s,r;let o={},a=null!=(n=t.meta.baseUrl)?n:"",l=null!=(s=to(null!=(i=t.meta.formats)?i:[]))?s:"ogg",u=null!=(r=t.global.default_path)?r:"";return e?e.regions.reduce((t,e)=>(e.sample&&(t[e.sample]=`${a}/${u}${e.sample}.${l}`),t),o):o}(n,s),i))})}(t,this.player.buffers,V(this,D),this.options.storage))).then(()=>this)}get output(){return this.player.output}loaded(){return K(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(t){X(this,w,F).call(this,"object"==typeof t?t:{note:t})}stop(t){this.player.stop(t)}disconnect(){this.player.disconnect()}};function t_(){return Object.keys(tM)}D=new WeakMap,w=new WeakSet,F=function(t){var e;let n=tm(t.note);if(void 0===n)return()=>void 0;let i=null!=(e=t.velocity)?e:this.options.velocity,s=function(t,e){let n=[];for(let i of t.groups)if(tP(e.midi,i.lokey,i.hikey)&&tP(e.velocity,i.lovel,i.hivel)&&tP(e.cc64,i.locc64,i.hicc64))for(let t of i.regions)tP(e.midi,t.lokey,t.hikey)&&tP(e.velocity,t.lovel,t.hivel)&&tP(e.cc64,i.locc64,i.hicc64)&&n.push([i,t]);return n}(V(this,D),{midi:n,velocity:i}),r=()=>{var e;null==(e=t.onEnded)||e.call(t,t)},o=s.map(([e,i])=>{var s,o,a;let l=null!=(o=null!=(s=i.pitch_keycenter)?s:i.key)?o:n,u=(n-l)*100;return this.player.start(U(z({},t),{note:i.sample,decayTime:t.decayTime,detune:u+(null!=(a=t.detune)?a:this.options.detune),onEnded:r,stopId:n}))});switch(o.length){case 0:return()=>void 0;case 1:return o[0];default:return t=>o.forEach(e=>e(t))}};var tM={CP80:"https://danigb.github.io/samples/gs-e-pianos/CP80/cp80.websfz.json",PianetT:"https://danigb.github.io/samples/gs-e-pianos/Pianet T/pianet-t.websfz.json",WurlitzerEP200:"https://danigb.github.io/samples/gs-e-pianos/Wurlitzer EP200/wurlitzer-ep200.websfz.json",TX81Z:"https://danigb.github.io/samples/vcsl/TX81Z/tx81z-fm-piano.websfz.json"},tb=class extends tv{constructor(t,e){var n;super(t,U(z({},e),{instrument:null!=(n=tM[e.instrument])?n:e.instrument}));let i=J(0);this.tremolo={level:t=>i.set(Y(t))};let s=function(t,e){let n=t.createGain(),i=t.createGain();n.channelCount=2,n.channelCountMode="explicit";let s=t.createChannelSplitter(2),r=t.createGain(),o=t.createGain(),a=t.createChannelMerger(2),l=t.createOscillator();l.type="sine",l.frequency.value=1,l.start();let u=t.createGain(),h=t.createOscillator();h.type="sine",h.frequency.value=1.1,h.start();let p=t.createGain();n.connect(s),s.connect(r,0),s.connect(o,1),r.connect(a,0,0),o.connect(a,0,1),l.connect(u),u.connect(r.gain),h.connect(p),p.connect(o.gain),a.connect(i);let c=e(t=>{u.gain.value=t,p.gain.value=t});return n.disconnect=()=>{c(),l.stop(),h.stop(),n.disconnect(s),s.disconnect(r,0),s.disconnect(o,1),r.disconnect(a,0,0),o.disconnect(a,0,1),l.disconnect(r),h.disconnect(o),a.disconnect(i)},{input:n,output:i}}(t,i.subscribe);this.output.addInsert(s)}};function tD(t={}){return{regions:[],sample:t}}function tw(t,e,n){let i=[],s=tm(e.note);if(void 0===s)return i;for(let r of t.regions){let o=tA(s,null!=n?n:0,e,r,t.sample);o&&i.push(o)}return i}function tF(t,e,n){let i=tm(e.note);if(void 0!==i)for(let s of t.regions){let r=tA(i,null!=n?n:0,e,s,t.sample);if(r)return r}}function tA(t,e,n,i,s){var r,o,a,l,u,h,p,c,d,f,m,y,P,g,v,_,M,b,D,w,F,A,k,S,I,E,C,G;if(!(t>=(null!=(r=i.midiLow)?r:0)&&t<(null!=(o=i.midiHigh)?o:127)+1)||!(void 0===n.velocity||n.velocity>=(null!=(a=i.velLow)?a:0)&&n.velocity<=(null!=(l=i.velHigh)?l:127))||i.seqLength&&e%i.seqLength!=(null!=(u=i.seqPosition)?u:1)-1)return;let B=t-i.midiPitch,N=null!=(h=n.velocity)?h:s.velocity,T=i.volume?Math.pow(10,i.volume/20):0,x=null!=(c=null!=(p=n.gainOffset)?p:s.gainOffset)?c:0,R=null!=(d=n.detune)?d:0;return{decayTime:null!=(y=null!=(m=null==n?void 0:n.decayTime)?m:null==(f=i.sample)?void 0:f.decayTime)?y:s.decayTime,detune:100*(B+(null!=(P=i.tune)?P:0))+R,duration:null!=(_=null!=(v=null==n?void 0:n.duration)?v:null==(g=i.sample)?void 0:g.duration)?_:s.duration,gainOffset:x+T||void 0,loop:null!=(D=null!=(b=null==n?void 0:n.loop)?b:null==(M=i.sample)?void 0:M.loop)?D:s.loop,loopEnd:null!=(A=null!=(F=null==n?void 0:n.loopEnd)?F:null==(w=i.sample)?void 0:w.loopEnd)?A:s.loopEnd,loopStart:null!=(I=null!=(S=null==n?void 0:n.loopStart)?S:null==(k=i.sample)?void 0:k.loopStart)?I:s.loopStart,lpfCutoffHz:null!=(G=null!=(C=null==n?void 0:n.lpfCutoffHz)?C:null==(E=i.sample)?void 0:E.lpfCutoffHz)?G:s.lpfCutoffHz,name:i.sampleName,note:t,onEnded:n.onEnded,onStart:n.onStart,stopId:n.name,time:n.time,velocity:void 0==N?void 0:N}}function tk(t){if(0===t.length)return[];if(t.sort((t,e)=>t.midiPitch-e.midiPitch),t[0].midiLow=0,t[0].midiHigh=127,1===t.length)return t;for(let e=1;e<t.length;e++){let n=t[e-1],i=t[e],s=Math.floor((n.midiPitch+i.midiPitch)/2);n.midiHigh=s,i.midiLow=s+1}return t[t.length-1].midiHigh=127,t}var tS=class{constructor(t,e){this.context=t,this.seqNum=0;let n=new Q(t,e);this.group=tD(),this.player=new tn(new ti(t,U(z({},e),{destination:n.input})),e),this.output=n}get buffers(){return this.player.buffers}start(t){let e=tw(this.group,"object"==typeof t?t:{note:t},this.seqNum);this.seqNum++;let n=e.map(t=>this.player.start(t));return t=>n.forEach(e=>e(t))}stop(t){if(void 0==t){this.player.stop();return}let e="object"==typeof t?t:{stopId:t},n=tm(e.stopId);n&&(e.stopId=n,this.player.stop(e))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function tI(t,e){let n=ta();return(i,s)=>K(this,null,function*(){let r=function(t,e){let n="global",i=t.split("\n").map(tN).filter(t=>!!t),s=new tT,r=[];for(let t of i)switch(t.type){case"mode":r.push(s.closeScope(n,e)),n=t.value;break;case"prop:num":case"prop:str":case"prop:num_arr":s.push(t.key,t.value);break;case"unknown":console.warn("Unknown SFZ token",t.value)}return r.filter(t=>!!t)}((yield fetch(t).then(t=>t.text())),e.group);r.length&&console.warn("Problems converting sfz",r);let o=new Set;return e.group.regions.forEach(t=>o.add(t.sampleName)),Promise.all(Array.from(o).map(t=>K(this,null,function*(){let r=e.urlFromSampleName(t,n),o=yield tr(i,r,s);e.buffers[t]=o})))})}var tE=/^<([^>]+)>$/,tC=/^([^=]+)=([-\.\d]+)$/,tG=/^([^=]+)=(.+)$/,tB=/^([^=]+)_(\d+)=(\d+)$/;function tN(t){if(""===(t=t.trim())||t.startsWith("//"))return;let e=t.match(tE);if(e)return{type:"mode",value:e[1]};let n=t.match(tB);if(n)return{type:"prop:num_arr",key:n[1],value:[Number(n[2]),Number(n[3])]};let i=t.match(tC);if(i)return{type:"prop:num",key:i[1],value:Number(i[2])};let s=t.match(tG);return s?{type:"prop:str",key:s[1],value:s[2]}:{type:"unknown",value:t}}var tT=class{constructor(){$(this,A),this.values={},this.global={},this.group={}}closeScope(t,e){if("global"===t)X(this,A,k).call(this,this.global);else if("group"===t)this.group=X(this,A,k).call(this,{});else if("region"===t){let t=X(this,A,k).call(this,z(z({sampleName:"",midiPitch:-1},this.global),this.group));if(""===t.sampleName)return"Missing sample name";if(-1===t.midiPitch){if(void 0===t.midiLow)return"Missing pitch_keycenter";t.midiPitch=t.midiLow}t.seqLength&&void 0===t.seqPosition&&(t.seqPosition=1),t.ampRelease&&(t.sample={decayTime:t.ampRelease},delete t.ampRelease),e.regions.push(t)}}get empty(){return 0===Object.keys(this.values).length}get keys(){return Object.keys(this.values)}push(t,e){this.values[t]=e}popNum(t,e,n){return"number"==typeof this.values[t]&&(e[n]=this.values[t],delete this.values[t],!0)}popStr(t,e,n){return"string"==typeof this.values[t]&&(e[n]=this.values[t],delete this.values[t],!0)}popNumArr(t,e,n){return!!Array.isArray(this.values[t])&&(e[n]=this.values[t],delete this.values[t],!0)}};A=new WeakSet,k=function(t){return this.popStr("sample",t,"sampleName"),this.popNum("pitch_keycenter",t,"midiPitch"),this.popNum("ampeg_attack",t,"ampAttack"),this.popNum("ampeg_release",t,"ampRelease"),this.popNum("bend_down",t,"bendDown"),this.popNum("bend_up",t,"bendUp"),this.popNum("group",t,"group"),this.popNum("hikey",t,"midiHigh"),this.popNum("hivel",t,"velHigh"),this.popNum("lokey",t,"midiLow"),this.popNum("offset",t,"offset"),this.popNum("lovel",t,"velLow"),this.popNum("off_by",t,"groupOffBy"),this.popNum("pitch_keytrack",t,"ignore"),this.popNum("seq_length",t,"seqLength"),this.popNum("seq_position",t,"seqPosition"),this.popNum("tune",t,"tune"),this.popNum("volume",t,"volume"),this.popNumArr("amp_velcurve",t,"ampVelCurve"),this.values={},t};var tx=[],tR="https://smpldsnds.github.io/sgossner-vcsl/";function tO(){return K(this,null,function*(){return tx.length?tx:tx=yield fetch(tR+"sfz_files.json").then(t=>t.json())})}var tL=class{constructor(t,e={}){var n,i;this.config={instrument:null!=(n=e.instrument)?n:"Arco",storage:null!=(i=e.storage)?i:tl},this.player=new tS(t,e);let s=function(t,e,n){let i=t.slice(0,t.lastIndexOf("/")+1),s=`https://smpldsnds.github.io/sgossner-vcsl/${i}`;return tI(tR+t+".sfz",{buffers:e,group:n,urlFromSampleName:(t,e)=>s+"/"+t.replace(".wav",e)})}(this.config.instrument,this.player.buffers,this.player.group);this.load=s(t,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){return this.player.start(t)}stop(t){return this.player.stop(t)}disconnect(){this.player.disconnect()}};function tj(){return Object.keys(tz)}var tW=class extends tL{constructor(t,e){var n;super(t,U(z({},e),{instrument:tz[null!=(n=e.instrument)?n:""]}))}},tz={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"},tU={"300 STRINGS CELLO":["300 STRINGS","CELL"],"300 STRINGS VIOLA":["300 STRINGS","VIOL"]};function tH(){return["300 STRINGS CELLO","300 STRINGS VIOLA","8VOICE CHOIR","BASSA+STRNGS","BOYS CHOIR","CHA CHA FLT","CHM CLARINET","CHMB 3 VLNS","CHMB ALTOSAX","CHMB FEMALE","CHMB MALE VC","CHMB TNR SAX","CHMB TRMBONE","CHMB TRUMPET","CHMBLN CELLO","CHMBLN FLUTE","CHMBLN OBOE","DIXIE+TRMBN","FOXTROT+SAX","HALFSP.BRASS","MIXED STRGS","MKII BRASS","MKII GUITAR","MKII ORGAN","MKII SAX","MKII VIBES","MKII VIOLINS","MOVE BS+STGS","STRGS+BRASS","TROMB+TRMPT","TRON 16VLNS","TRON CELLO","TRON FLUTE","TRON VIOLA"]}var tV=class{constructor(t,e){var n,i,s,r,o;let a;this.context=t,this.config={instrument:null!=(n=e.instrument)?n:"MKII VIOLINS",storage:null!=(i=e.storage)?i:tl},this.player=new ts(t,e),this.group=tD(e);let l=(s=this.config.instrument,r=this.player.buffers,o=this.group,(a=tU[s])&&(s=a[0]),(t,e)=>{let n=`https://smpldsnds.github.io/archiveorg-mellotron/${s}/`,i=ta();return fetch(n+"files.json").then(t=>t.json()).then(s=>Promise.all(s.map(s=>{var l;if(a&&!s.includes(a[1]))return;let u=tm(null!=(l=s.split(" ")[0])?l:"");u&&tr(t,n+s+i,e).then(t=>{var e;r[s]=t;let n=null!=(e=null==t?void 0:t.duration)?e:0;o.regions.push({sampleName:s,midiPitch:u,sample:{loop:!0,loopStart:n/10,loopEnd:n-n/10}})})}))).then(()=>{tk(o.regions)})});this.load=l(t,this.config.storage).then(()=>this)}get buffers(){return this.player.buffers}get output(){return this.player.output}start(t){let e=tF(this.group,"object"==typeof t?t:{note:t});return e?this.player.start(e):()=>void 0}stop(t){this.player.stop(t)}disconnect(){this.player.disconnect()}},t$=["preDelay","bandwidth","inputDiffusion1","inputDiffusion2","decay","decayDiffusion1","decayDiffusion2","damping","excursionRate","excursionDepth","wet","dry"],tq=new WeakMap,tX=class{constructor(t){$(this,S,void 0),$(this,I,void 0),$(this,E,void 0),this.input=t.createGain(),q(this,E,t.destination),q(this,I,(function(t){return K(this,null,function*(){let e=tq.get(t);if(!e){let n=new Blob(['"use strict";(()=>{var f=class extends AudioWorkletProcessor{_pDLength;_preDelay;_pDWrite;_lp1;_lp2;_lp3;_excPhase;_taps;_Delays;sampleRate;static get parameterDescriptors(){return[["preDelay",0,0,sampleRate-1,"k-rate"],["bandwidth",.9999,0,1,"k-rate"],["inputDiffusion1",.75,0,1,"k-rate"],["inputDiffusion2",.625,0,1,"k-rate"],["decay",.5,0,1,"k-rate"],["decayDiffusion1",.7,0,.999999,"k-rate"],["decayDiffusion2",.5,0,.999999,"k-rate"],["damping",.005,0,1,"k-rate"],["excursionRate",.5,0,2,"k-rate"],["excursionDepth",.7,0,2,"k-rate"],["wet",1,0,1,"k-rate"],["dry",0,0,1,"k-rate"]].map(e=>new Object({name:e[0],defaultValue:e[1],minValue:e[2],maxValue:e[3],automationRate:e[4]}))}constructor(e){super(),this.sampleRate=sampleRate,this._Delays=[],this._pDLength=sampleRate+(128-sampleRate%128),this._preDelay=new Float32Array(this._pDLength),this._pDWrite=0,this._lp1=0,this._lp2=0,this._lp3=0,this._excPhase=0,[.004771345,.003595309,.012734787,.009307483,.022579886,.149625349,.060481839,.1249958,.030509727,.141695508,.089244313,.106280031].forEach(a=>this.makeDelay(a,sampleRate)),this._taps=Int16Array.from([.008937872,.099929438,.064278754,.067067639,.066866033,.006283391,.035818689,.011861161,.121870905,.041262054,.08981553,.070931756,.011256342,.004065724],a=>Math.round(a*sampleRate))}makeDelay(e,a){let t=Math.round(e*a),s=2**Math.ceil(Math.log2(t));this._Delays.push([new Float32Array(s),t-1,0,s-1])}writeDelay(e,a){return this._Delays[e][0][this._Delays[e][1]]=a}readDelay(e){return this._Delays[e][0][this._Delays[e][2]]}readDelayAt(e,a){let t=this._Delays[e];return t[0][t[2]+a&t[3]]}readDelayCAt(e,a){let t=this._Delays[e],s=a-~~a,d=~~a+t[2]-1,r=t[3],D=t[0][d++&r],l=t[0][d++&r],h=t[0][d++&r],y=t[0][d&r],u=(3*(l-h)-D+y)/2,m=2*h+D-(5*l+y)/2,c=(h-D)/2;return((u*s+m)*s+c)*s+l}process(e,a,t){let s=~~t.preDelay[0],d=t.bandwidth[0],r=t.inputDiffusion1[0],D=t.inputDiffusion2[0],l=t.decay[0],h=t.decayDiffusion1[0],y=t.decayDiffusion2[0],u=1-t.damping[0],m=t.excursionRate[0]/sampleRate,c=t.excursionDepth[0]*sampleRate/1e3,w=t.wet[0]*.6,A=t.dry[0];if(e[0].length==2)for(let i=127;i>=0;i--)this._preDelay[this._pDWrite+i]=(e[0][0][i]+e[0][1][i])*.5,a[0][0][i]=e[0][0][i]*A,a[0][1][i]=e[0][1][i]*A;else if(e[0].length>0){this._preDelay.set(e[0][0],this._pDWrite);for(let i=127;i>=0;i--)a[0][0][i]=a[0][1][i]=e[0][0][i]*A}else this._preDelay.set(new Float32Array(128),this._pDWrite);let o=0;for(;o<128;){let i=0,b=0;this._lp1+=d*(this._preDelay[(this._pDLength+this._pDWrite-s+o)%this._pDLength]-this._lp1);let p=this.writeDelay(0,this._lp1-r*this.readDelay(0));p=this.writeDelay(1,r*(p-this.readDelay(1))+this.readDelay(0)),p=this.writeDelay(2,r*p+this.readDelay(1)-D*this.readDelay(2)),p=this.writeDelay(3,D*(p-this.readDelay(3))+this.readDelay(2));let k=D*p+this.readDelay(3),g=c*(1+Math.cos(this._excPhase*6.28)),x=c*(1+Math.sin(this._excPhase*6.2847)),_=this.writeDelay(4,k+l*this.readDelay(11)+h*this.readDelayCAt(4,g));this.writeDelay(5,this.readDelayCAt(4,g)-h*_),this._lp2+=u*(this.readDelay(5)-this._lp2),_=this.writeDelay(6,l*this._lp2-y*this.readDelay(6)),this.writeDelay(7,this.readDelay(6)+y*_),_=this.writeDelay(8,k+l*this.readDelay(7)+h*this.readDelayCAt(8,x)),this.writeDelay(9,this.readDelayCAt(8,x)-h*_),this._lp3+=u*(this.readDelay(9)-this._lp3),_=this.writeDelay(10,l*this._lp3-y*this.readDelay(10)),this.writeDelay(11,this.readDelay(10)+y*_),i=this.readDelayAt(9,this._taps[0])+this.readDelayAt(9,this._taps[1])-this.readDelayAt(10,this._taps[2])+this.readDelayAt(11,this._taps[3])-this.readDelayAt(5,this._taps[4])-this.readDelayAt(6,this._taps[5])-this.readDelayAt(7,this._taps[6]),b=this.readDelayAt(5,this._taps[7])+this.readDelayAt(5,this._taps[8])-this.readDelayAt(6,this._taps[9])+this.readDelayAt(7,this._taps[10])-this.readDelayAt(9,this._taps[11])-this.readDelayAt(10,this._taps[12])-this.readDelayAt(11,this._taps[13]),a[0][0][o]+=i*w,a[0][1][o]+=b*w,this._excPhase+=m,o++;for(let R=0,n=this._Delays[0];R<this._Delays.length;n=this._Delays[++R])n[1]=n[1]+1&n[3],n[2]=n[2]+1&n[3]}return this._pDWrite=(this._pDWrite+128)%this._pDLength,!0}};registerProcessor("DattorroReverb",f);})();'],{type:"application/javascript"}),i=URL.createObjectURL(n);e=t.audioWorklet.addModule(i),tq.set(t,e)}return yield e,new AudioWorkletNode(t,"DattorroReverb",{outputChannelCount:[2]})})})(t).then(t=>(this.input.connect(t),t.connect(V(this,E)),q(this,S,t),this)))}get paramNames(){return t$}getParam(t){var e;return null==(e=V(this,S))?void 0:e.parameters.get("preDelay")}get isReady(){return void 0!==V(this,S)}ready(){return V(this,I)}connect(t){V(this,S)&&(V(this,S).disconnect(V(this,E)),V(this,S).connect(t)),q(this,E,t)}};S=new WeakMap,I=new WeakMap,E=new WeakMap;var tK=class{constructor(t,e={}){var n,i,s,r,o,a;this.context=t,$(this,C,void 0),q(this,C,{destination:null!=(n=e.destination)?n:t.destination,detune:0,volume:null!=(i=e.volume)?i:100,velocity:null!=(s=e.velocity)?s:100,buffers:null!=(r=e.buffers)?r:{},volumeToGain:null!=(o=e.volumeToGain)?o:Y}),this.player=new ts(t,V(this,C));let l=null!=(a=e.storage)?a:tl,u="function"==typeof V(this,C).buffers?V(this,C).buffers:function(t,e){return(n,i)=>K(this,null,function*(){yield Promise.all([Object.keys(t).map(s=>K(this,null,function*(){let r=t[s];if(r instanceof AudioBuffer)i[s]=r;else if("string"==typeof r){let t=yield tr(n,r,e);t&&(i[s]=t)}}))])})}(V(this,C).buffers,l);this.load=u(t,this.player.buffers).then(()=>this)}loaded(){return K(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get output(){return this.player.output}start(t){return this.player.start("object"==typeof t?t:{note:t})}stop(t){return this.player.stop("object"==typeof t?t:void 0===t?void 0:{stopId:t})}disconnect(){return this.player.disconnect()}};function tZ(){return["Pizzicato","Arco","Switched"]}C=new WeakMap;var tJ=class{constructor(t,e={}){var n,i,s;this.seqNum=0,this.config={instrument:null!=(n=e.instrument)?n:"Arco",storage:null!=(i=e.storage)?i:tl},this.player=new ts(t,e),this.group=tD();let r=tI((s=this.config.instrument,`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${({Arco:"arco",Pizzicato:"pizz",Switched:"switched"})[s]}.sfz`),{buffers:this.player.buffers,group:this.group,urlFromSampleName:(t,e)=>{let n=t.replace("\\","/").replace(".wav",e);return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${n}`}});this.load=r(t,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){let e=tw(this.group,"object"==typeof t?t:{note:t},this.seqNum);this.seqNum++;let n=e.map(t=>this.player.start(t));return t=>n.forEach(e=>e(t))}stop(t){if(void 0==t){this.player.stop();return}let e="object"==typeof t?t:{stopId:t},n=tm(e.stopId);n&&(e.stopId=n,this.player.stop(e))}disconnect(){this.player.disconnect()}},tY=["MusyngKite","FluidR3_GM"],tQ=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function t0(){return tY}function t1(){return tQ}var t2=class{constructor(t,e){this.context=t,$(this,G,void 0),this.config=function(t){var e,n,i,s;if(!t.instrument&&!t.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");let r={kit:"MusyngKite",instrument:t.instrument,storage:null!=(e=t.storage)?e:tl,extraGain:null!=(n=t.extraGain)?n:5,loadLoopData:null!=(i=t.loadLoopData)&&i,loopDataUrl:t.loopDataUrl,instrumentUrl:null!=(s=t.instrumentUrl)?s:""};return r.instrument&&r.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),r.instrumentUrl=r.instrument,r.instrument=void 0),r.instrument&&!r.instrumentUrl&&(r.instrumentUrl=function(t,e){var n;let i=null!=(n=to(["ogg","mp3"]))?n:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${e}/${t}-${i}.js`}(r.instrument,r.kit)),r.loadLoopData&&r.instrument&&!r.loopDataUrl&&(r.loopDataUrl=function(t,e){if(!t.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${e}/${t}-loop.json`}(r.instrument,r.kit)),r}(e),this.player=new ts(t,e),this.group=tD(),q(this,G,!1);let n=function(t,e,n,i){let s=function(t,e,n){return(i,s)=>K(this,null,function*(){let r=function(t){let e=t.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");let n=t.indexOf("=",e)+2,i=t.lastIndexOf(",");return JSON.parse(t.slice(n,i)+"}")}((yield(yield s.fetch(t)).text())),o=Object.keys(r);yield Promise.all(o.map(t=>K(this,null,function*(){var s;let o=tm(t);if(!o)return;let a=function(t){let e=window.atob(t),n=e.length,i=new Uint8Array(n);for(let t=0;t<n;t++)i[t]=e.charCodeAt(t);return i.buffer}((s=r[t]).slice(s.indexOf(",")+1)),l=yield i.decodeAudioData(a);e[t]=l,n.regions.push({sampleName:t,midiPitch:o})}))),tk(n.regions)})}(t,n,i);return(t,n)=>K(this,null,function*(){let[r,o]=yield Promise.all([s(t,n),function(t,e=44100){return K(this,null,function*(){if(t)try{let n=yield fetch(t);if(200!==n.status)return;let i=yield n.json(),s={};return Object.keys(i).forEach(t=>{let n=tm(t);if(n){let r=i[t];s[n]=[r[0]/e,r[1]/e]}}),s}catch(t){return}})}(e)]);return o&&i.regions.forEach(t=>{let e=o[t.midiPitch];e&&(null!=t.sample||(t.sample={}),t.sample.loop=!0,t.sample.loopStart=e[0],t.sample.loopEnd=e[1])}),!!o})}(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=n(t,this.config.storage).then(t=>(q(this,G,t),this));let i=t.createGain();i.gain.value=this.config.extraGain,this.player.output.addInsert(i)}get output(){return this.player.output}get hasLoops(){return V(this,G)}loaded(){return K(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(t){let e=tF(this.group,"object"==typeof t?t:{note:t});return e?this.player.start(e):()=>void 0}stop(t){return this.player.stop(t)}};G=new WeakMap;var t5=class{constructor(t,e){this.context=t,$(this,B),this.options=Object.assign({baseUrl:"https://danigb.github.io/samples/splendid-grand-piano",storage:tl,detune:0,volume:100,velocity:100,decayTime:.5},e),this.player=new ts(t,this.options);let n=function(t,e,n){var i;let s=null!=(i=to(["ogg","m4a"]))?i:"ogg",r=n?t6.filter(t=>t.vel_range[0]<=n.velocityRange[1]&&t.vel_range[1]>=n.velocityRange[0]):t6;return(i,o)=>K(this,null,function*(){for(let a of r){let r=n?a.samples.filter(t=>n.notes.includes(t[0])):a.samples;yield Promise.all(r.map(n=>K(this,[n],function*([n,r]){let l=`${t}/${r}.${s}`,u=yield tr(i,l,e);u&&(o[a.name+n]=u)})))}})}(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=n(t,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return K(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(t){var e,n;let i="object"==typeof t?z({},t):{note:t},s=X(this,B,N).call(this,i);return s?(i.note=s[0],i.stopId=null!=(e=i.stopId)?e:s[1],i.detune=s[2]+(null!=(n=i.detune)?n:this.options.detune),this.player.start(i)):()=>void 0}stop(t){return this.player.stop(t)}};B=new WeakSet,N=function(t){var e;let n=tm(t.note);if(!n)return;let i=null!=(e=t.velocity)?e:this.options.velocity,s=t6.findIndex(t=>i>=t.vel_range[0]&&i<=t.vel_range[1]),r=t6[s];if(r)return function(t,e,n){let i=0;for(;void 0===n[t+(e+i)]&&i<128;)i=i>0?-i:-i+1;return 127===i?[t+e,e,0]:[t+(e+i),e,-(100*i)]}(r.name,n,this.player.buffers)};var t6=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}]}}]);