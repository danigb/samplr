"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{1513:function(t,e,n){let i;function s(){return null!=i||(i=new AudioContext),i}n.d(e,{k:function(){return s}})},744:function(t,e,n){n.d(e,{Be:function(){return t5},Dc:function(){return tj},Dy:function(){return t2},E8:function(){return tK},Io:function(){return t3},Jp:function(){return tz},No:function(){return tm},TU:function(){return tY},Z4:function(){return tZ},Zx:function(){return tV},a0:function(){return t$},ab:function(){return t6},co:function(){return tJ},mK:function(){return td},mb:function(){return tM},o6:function(){return tL},wz:function(){return tW},xA:function(){return th},xU:function(){return tD},zP:function(){return t1}});var i,s,r,o,l,a,u,h,p,c,d,f,m,y,g,P,v,_,M,b,D,w,F,A,k,S,I,E,C,G,B,N,T,R=Object.defineProperty,x=Object.defineProperties,O=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,z=(t,e,n)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,U=(t,e)=>{for(var n in e||(e={}))j.call(e,n)&&z(t,n,e[n]);if(L)for(var n of L(e))W.call(e,n)&&z(t,n,e[n]);return t},H=(t,e)=>x(t,O(e)),V=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},$=(t,e,n)=>(V(t,e,"read from private field"),n?n.call(t):e.get(t)),q=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},X=(t,e,n,i)=>(V(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),K=(t,e,n)=>(V(t,e,"access private method"),n),Z=(t,e,n)=>new Promise((i,s)=>{var r=t=>{try{l(n.next(t))}catch(t){s(t)}},o=t=>{try{l(n.throw(t))}catch(t){s(t)}},l=t=>t.done?i(t.value):Promise.resolve(t.value).then(r,o);l((n=n.apply(t,e)).next())});function J(t){let e=t.filter(t=>!!t);return e.reduce((t,e)=>{let n="output"in t?t.output:t,i="input"in e?e.input:e;return n.connect(i),e}),()=>{e.reduce((t,e)=>{let n="output"in t?t.output:t,i="input"in e?e.input:e;return n.disconnect(i),e})}}function Y(t){let e=t,n=new Set;return{subscribe:function(t){return n.add(t),t(e),()=>{n.delete(t)}},set:function(t){e=t,n.forEach(t=>t(e))},get:function(){return e}}}function Q(t){return t*t/16129}var tt=class{constructor(t,e){var n,h,p;this.context=t,q(this,i,void 0),q(this,s,void 0),q(this,r,void 0),q(this,o,void 0),q(this,l,void 0),q(this,a,void 0),q(this,u,!1),X(this,a,{destination:null!=(n=null==e?void 0:e.destination)?n:t.destination,volume:null!=(h=null==e?void 0:e.volume)?h:100,volumeToGain:null!=(p=null==e?void 0:e.volumeToGain)?p:Q}),this.input=t.createGain(),X(this,i,t.createGain()),X(this,o,J([this.input,$(this,i),$(this,a).destination]));let c=Y($(this,a).volume);this.setVolume=c.set,X(this,l,c.subscribe(t=>{$(this,i).gain.value=$(this,a).volumeToGain(t)}))}addInsert(t){if($(this,u))throw Error("Can't add insert to disconnected channel");null!=$(this,r)||X(this,r,[]),$(this,r).push(t),$(this,o).call(this),X(this,o,J([this.input,...$(this,r),$(this,i),$(this,a).destination]))}addEffect(t,e,n){if($(this,u))throw Error("Can't add effect to disconnected channel");let r=this.context.createGain();r.gain.value=n;let o="input"in e?e.input:e,l=J([$(this,i),r,o]);null!=$(this,s)||X(this,s,[]),$(this,s).push({name:t,mix:r,disconnect:l})}sendEffect(t,e){var n;if($(this,u))throw Error("Can't send effect to disconnected channel");let i=null==(n=$(this,s))?void 0:n.find(e=>e.name===t);i?i.mix.gain.value=e:console.warn("Send bus not found: "+t)}disconnect(){var t;$(this,u)||(X(this,u,!0),$(this,o).call(this),$(this,l).call(this),null==(t=$(this,s))||t.forEach(t=>t.disconnect()),X(this,s,void 0))}};i=new WeakMap,s=new WeakMap,r=new WeakMap,o=new WeakMap,l=new WeakMap,a=new WeakMap,u=new WeakMap;var te=class{constructor(t){this.compare=t,q(this,h,[])}push(t){let e=$(this,h).length,n=0,i=e-1,s=e;for(;n<=i;){let e=Math.floor((n+i)/2);0>this.compare(t,$(this,h)[e])?(s=e,i=e-1):n=e+1}$(this,h).splice(s,0,t)}pop(){return $(this,h).shift()}peek(){return $(this,h)[0]}removeAll(t){let e=$(this,h).length;return X(this,h,$(this,h).filter(e=>!t(e))),$(this,h).length!==e}clear(){X(this,h,[])}size(){return $(this,h).length}};function tn(t,e){return t&&e?n=>{t(n),e(n)}:null!=t?t:e}h=new WeakMap;var ti=class{constructor(t,e={}){q(this,p,void 0),q(this,c,void 0),q(this,d,void 0),X(this,p,function(t){var e,n;let i={scheduleLookaheadMs:null!=(e=t.scheduleLookaheadMs)?e:200,scheduleIntervalMs:null!=(n=t.scheduleIntervalMs)?n:50,onStart:t.onStart,onEnded:t.onEnded};if(i.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(i.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(i.scheduleLookaheadMs<i.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return i}(e)),X(this,c,new te((t,e)=>t.time-e.time)),this.player=t}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return void 0!==$(this,d)}start(t){var e;let n=this.player.context,i=n.currentTime,s=null!=(e=t.time)?e:i,r=$(this,p).scheduleLookaheadMs/1e3;return(t.onStart=tn(t.onStart,$(this,p).onStart),t.onEnded=tn(t.onEnded,$(this,p).onEnded),s<i+r)?this.player.start(t):($(this,c).push(H(U({},t),{time:s})),$(this,d)||X(this,d,setInterval(()=>{let t=n.currentTime+r;for(;$(this,c).size()&&$(this,c).peek().time<=t;){let t=$(this,c).pop();t&&this.player.start(t)}$(this,c).size()||(clearInterval($(this,d)),X(this,d,void 0))},$(this,p).scheduleIntervalMs)),e=>{(!e||e<s)&&$(this,c).removeAll(e=>e===t)||this.player.stop(H(U({},t),{time:e}))})}stop(t){var e;if(this.player.stop(t),!t){$(this,c).clear();return}let n=null!=(e=null==t?void 0:t.time)?e:0,i=null==t?void 0:t.stopId;i?$(this,c).removeAll(t=>t.time>=n&&t.stopId?t.stopId===i:t.note===i):$(this,c).removeAll(t=>t.time>=n)}disconnect(){this.player.disconnect()}};p=new WeakMap,c=new WeakMap,d=new WeakMap;var ts=class{constructor(t,e){var n,i;this.context=t,this.options=e,q(this,f,void 0),q(this,m,!1),q(this,y,void 0),X(this,f,{velocityToGain:null!=(n=e.velocityToGain)?n:Q,destination:null!=(i=e.destination)?i:t.destination}),this.buffers={},X(this,y,function(){let t=new Set;return{subscribe:function(e){return t.add(e),()=>{t.delete(e)}},trigger:function(e){t.forEach(t=>t(e))}}}())}start(t){var e,n,i,s,r,o,l,a,u,h,p,c,d,g,P;let v;if($(this,m))throw Error("Can't start a sample on disconnected player");let _=this.context,M=t.name&&this.buffers[t.name]||this.buffers[t.note];if(!M)return console.warn(`Sample not found: '${t.note}'`),()=>void 0;let b=_.createBufferSource();b.buffer=M;let D=null!=(n=null!=(e=t.detune)?e:this.options.detune)?n:0;b.detune?b.detune.value=D:b.playbackRate&&(b.playbackRate.value=Math.pow(2,D/1200));let w=null!=(i=t.lpfCutoffHz)?i:this.options.lpfCutoffHz,F=w?_.createBiquadFilter():void 0;w&&F&&(F.type="lowpass",F.frequency.value=w);let A=_.createGain(),k=null!=(r=null!=(s=t.velocity)?s:this.options.velocity)?r:100;A.gain.value=$(this,f).velocityToGain(k),(null!=(o=t.loop)?o:this.options.loop)&&(b.loop=!0,b.loopStart=null!=(l=t.loopStart)?l:0,b.loopEnd=null!=(a=t.loopEnd)?a:M.duration);let[S,I]=function(t,e=.2){let n=0,i=t.createGain();return i.gain.value=1,[i,function(s){if(n)return n;i.gain.cancelScheduledValues(s);let r=s||t.currentTime;return n=r+e,i.gain.setValueAtTime(1,r),i.gain.linearRampToValueAtTime(0,n),n}]}(_,null!=(u=t.decayTime)?u:this.options.decayTime);function E(t){if(null!=t||(t=_.currentTime),t<=N)b.stop(t);else{let e=I(t);b.stop(e)}}let C=t.gainOffset?_.createGain():void 0;C&&t.gainOffset&&(C.gain.value=t.gainOffset);let G=null!=(h=t.stopId)?h:t.note,B=(P=[J([b,F,A,S,C,$(this,f).destination]),null==(p=t.stop)?void 0:p.call(t,E),$(this,y).subscribe(t=>{t&&void 0!==t.stopId&&t.stopId!==G||E(null==t?void 0:t.time)})],v=!1,()=>{v||(v=!0,P.forEach(t=>null==t?void 0:t()))});b.onended=()=>{var e;B(),null==(e=t.onEnded)||e.call(t,t)},null==(c=t.onStart)||c.call(t,t);let N=Math.max(null!=(d=t.time)?d:0,_.currentTime);b.start(t.time);let T=null!=(g=t.duration)?g:M.duration;return"number"==typeof t.duration&&E(N+T),E}stop(t){$(this,y).trigger(t)}disconnect(){$(this,m)||(X(this,m,!0),this.stop(),Object.keys(this.buffers).forEach(t=>{delete this.buffers[t]}))}get connected(){return!$(this,m)}};f=new WeakMap,m=new WeakMap,y=new WeakMap;var tr=class{constructor(t,e){this.context=t;let n=new tt(t,e);this.player=new ti(new ts(t,H(U({},e),{destination:n.input})),e),this.output=n}get buffers(){return this.player.buffers}start(t){return this.player.start(t)}stop(t){this.player.stop("object"==typeof t?t:void 0!==t?{stopId:t}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function to(t,e,n){return Z(this,null,function*(){e=e.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");let i=yield n.fetch(e);if(200!==i.status){console.warn("Error loading buffer. Invalid status: ",i.status,e);return}try{let e=yield i.arrayBuffer();return yield t.decodeAudioData(e)}catch(t){console.warn("Error loading buffer",t,e)}})}function tl(t){if("undefined"==typeof document)return null;let e=document.createElement("audio");for(let n=0;n<t.length;n++){let i=t[n],s=e.canPlayType(`audio/${i}`);if("probably"===s||"maybe"===s)return i;if("m4a"===i){let t=e.canPlayType("audio/aac");if("probably"===t||"maybe"===t)return i}}return null}function ta(){var t;return"."+(null!=(t=tl(["ogg","m4a"]))?t:"ogg")}var tu={fetch:t=>fetch(t)},th=class{constructor(t="smplr"){q(this,P),q(this,_),q(this,g,void 0),"undefined"!=typeof window&&"caches"in window?X(this,g,caches.open(t)):X(this,g,Promise.reject("CacheStorage not supported"))}fetch(t){return Z(this,null,function*(){let e=new Request(t);try{return yield K(this,P,v).call(this,e)}catch(n){let t=yield fetch(e);return yield K(this,_,M).call(this,e,t),t}})}};function tp(t){return"object"==typeof t&&"string"==typeof t.baseUrl&&"string"==typeof t.name&&Array.isArray(t.samples)&&Array.isArray(t.sampleNames)&&"object"==typeof t.nameToSample&&"object"==typeof t.sampleNameVariations}g=new WeakMap,P=new WeakSet,v=function(t){return Z(this,null,function*(){let e=yield $(this,g),n=yield e.match(t);if(n)return n;throw Error("Not found")})},_=new WeakSet,M=function(t,e){return Z(this,null,function*(){try{let n=yield $(this,g);yield n.put(t,e.clone())}catch(t){}})};var tc={baseUrl:"",name:"",samples:[],sampleNames:[],nameToSample:{},sampleNameVariations:{}};function td(){return Object.keys(tf)}var tf={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"},tm=class{constructor(t,e){q(this,b,tc);let n=function(t){var e,n,i;let s={instrument:null!=(e=null==t?void 0:t.instrument)?e:"TR-808",storage:null!=(n=null==t?void 0:t.storage)?n:tu,url:null!=(i=null==t?void 0:t.url)?i:""};if("string"==typeof s.instrument){if(s.url||(s.url=tf[s.instrument]),!s.url)throw Error("Invalid instrument: "+s.instrument)}else if(!tp(s.instrument))throw Error("Invalid instrument: "+s.instrument);return s}(e),i=tp(n.instrument)?Promise.resolve(n.instrument):function(t,e){return Z(this,null,function*(){var n,i;let s=yield e.fetch(t),r=yield s.json();for(let e of(r.baseUrl=t.replace("/dm.json",""),r.sampleNames=[],r.nameToSample={},r.sampleNameVariations={},r.samples)){let t=-1!==e.indexOf("/")?e:e.replace("-","/");r.nameToSample[t]=t;let[s,o]=t.split("/");r.sampleNames.includes(s)||r.sampleNames.push(s),null!=(n=r.nameToSample)[s]||(n[s]=t),null!=(i=r.sampleNameVariations)[s]||(i[s]=[]),o&&r.sampleNameVariations[s].push(`${s}/${o}`)}return r})}(n.url,n.storage);this.player=new tr(t,e),this.output=this.player.output,this.load=(function(t,e,n,i){var s;let r=null!=(s=tl(["ogg","m4a"]))?s:"ogg";return n.then(n=>Promise.all(n.samples.map(s=>Z(this,null,function*(){let o=`${n.baseUrl}/${s}.${r}`,l=-1!==s.indexOf("/")?s:s.replace("-","/"),a=yield to(t,o,i);a&&(e[l]=a)}))))})(t,this.player.buffers,i,n.storage).then(()=>this),i.then(t=>{X(this,b,t)})}loaded(){return Z(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return $(this,b).sampleNames}getVariations(t){var e;return null!=(e=$(this,b).sampleNameVariations[t])?e:[]}start(t){var e;let n=$(this,b).nameToSample[t.note];return this.player.start(H(U({},t),{note:n||t.note,stopId:null!=(e=t.stopId)?e:t.note}))}stop(t){return this.player.stop(t)}};function ty(t){return void 0===t?void 0:"number"==typeof t?t:function(t){let e=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(t);if(!e)return;let n=e[1].toUpperCase();if(!n)return;let i=e[2],s="b"===i[0]?-i.length:i.length,r=e[3]?+e[3]:4;return[0,2,4,5,7,9,11][(n.charCodeAt(0)+3)%7]+s+12*(r+1)}(t)}function tg(t,e){return Z(this,null,function*(){try{let e=yield fetch(t);return yield e.json()}catch(e){throw console.warn(`Can't load SFZ file ${t}`,e),Error(`Can't load SFZ file ${t}`)}})}function tP(t,e,n){return(void 0===e||void 0!==t&&t>=e)&&(void 0===n||void 0!==t&&t<=n)}b=new WeakMap;var tv=Object.freeze({meta:{},global:{},groups:[]}),t_=class{constructor(t,e){this.context=t,q(this,w),q(this,D,void 0),this.options=Object.freeze(Object.assign({volume:100,velocity:100,storage:tu,detune:0,destination:t.destination},e)),this.player=new tr(t,e),X(this,D,tv),this.load=(function(t,e){return Z(this,null,function*(){if("string"==typeof t)return tg(t,e);if("global"in t)return t;if("websfzUrl"in t){let n=yield tg(t.websfzUrl,e);return null!=n.meta||(n.meta={}),t.name&&(n.meta.name=t.name),t.baseUrl&&(n.meta.baseUrl=t.baseUrl),t.formats&&(n.meta.formats=t.formats),n}throw Error("Invalid instrument: "+JSON.stringify(t))})})(e.instrument,this.options.storage).then(e=>(X(this,D,Object.freeze(e)),function(t,e,n,i){return Z(this,null,function*(){n.groups.forEach(s=>(function(t,e,n,i){return Z(this,null,function*(){yield Promise.all(Object.keys(n).map(s=>Z(this,null,function*(){if(e[s])return;let r=yield to(t,n[s],i);return r&&(e[s]=r),e})))})})(t,e,function(t,e){var n,i,s,r;let o={},l=null!=(n=t.meta.baseUrl)?n:"",a=null!=(s=tl(null!=(i=t.meta.formats)?i:[]))?s:"ogg",u=null!=(r=t.global.default_path)?r:"";return e?e.regions.reduce((t,e)=>(e.sample&&(t[e.sample]=`${l}/${u}${e.sample}.${a}`),t),o):o}(n,s),i))})}(t,this.player.buffers,$(this,D),this.options.storage))).then(()=>this)}get output(){return this.player.output}loaded(){return Z(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(t){K(this,w,F).call(this,"object"==typeof t?t:{note:t})}stop(t){this.player.stop(t)}disconnect(){this.player.disconnect()}};function tM(){return Object.keys(tb)}D=new WeakMap,w=new WeakSet,F=function(t){var e;let n=ty(t.note);if(void 0===n)return()=>void 0;let i=null!=(e=t.velocity)?e:this.options.velocity,s=function(t,e){let n=[];for(let i of t.groups)if(tP(e.midi,i.lokey,i.hikey)&&tP(e.velocity,i.lovel,i.hivel)&&tP(e.cc64,i.locc64,i.hicc64))for(let t of i.regions)tP(e.midi,t.lokey,t.hikey)&&tP(e.velocity,t.lovel,t.hivel)&&tP(e.cc64,i.locc64,i.hicc64)&&n.push([i,t]);return n}($(this,D),{midi:n,velocity:i}),r=()=>{var e;null==(e=t.onEnded)||e.call(t,t)},o=s.map(([e,i])=>{var s,o,l;let a=null!=(o=null!=(s=i.pitch_keycenter)?s:i.key)?o:n,u=(n-a)*100;return this.player.start(H(U({},t),{note:i.sample,decayTime:t.decayTime,detune:u+(null!=(l=t.detune)?l:this.options.detune),onEnded:r,stopId:n}))});switch(o.length){case 0:return()=>void 0;case 1:return o[0];default:return t=>o.forEach(e=>e(t))}};var tb={CP80:"https://danigb.github.io/samples/gs-e-pianos/CP80/cp80.websfz.json",PianetT:"https://danigb.github.io/samples/gs-e-pianos/Pianet T/pianet-t.websfz.json",WurlitzerEP200:"https://danigb.github.io/samples/gs-e-pianos/Wurlitzer EP200/wurlitzer-ep200.websfz.json",TX81Z:"https://danigb.github.io/samples/vcsl/TX81Z/tx81z-fm-piano.websfz.json"},tD=class extends t_{constructor(t,e){var n;super(t,H(U({},e),{instrument:null!=(n=tb[e.instrument])?n:e.instrument}));let i=Y(0);this.tremolo={level:t=>i.set(Q(t))};let s=function(t,e){let n=t.createGain(),i=t.createGain();n.channelCount=2,n.channelCountMode="explicit";let s=t.createChannelSplitter(2),r=t.createGain(),o=t.createGain(),l=t.createChannelMerger(2),a=t.createOscillator();a.type="sine",a.frequency.value=1,a.start();let u=t.createGain(),h=t.createOscillator();h.type="sine",h.frequency.value=1.1,h.start();let p=t.createGain();n.connect(s),s.connect(r,0),s.connect(o,1),r.connect(l,0,0),o.connect(l,0,1),a.connect(u),u.connect(r.gain),h.connect(p),p.connect(o.gain),l.connect(i);let c=e(t=>{u.gain.value=t,p.gain.value=t});return n.disconnect=()=>{c(),a.stop(),h.stop(),n.disconnect(s),s.disconnect(r,0),s.disconnect(o,1),r.disconnect(l,0,0),o.disconnect(l,0,1),a.disconnect(r),h.disconnect(o),l.disconnect(i)},{input:n,output:i}}(t,i.subscribe);this.output.addInsert(s)}};function tw(){return{regions:[]}}function tF(t,e,n,i){let s=[],r=ty(e.note);if(void 0===r)return s;for(let o of t.regions){let t=tk(r,null!=n?n:0,e,o,i);t&&s.push(t)}return s}function tA(t,e,n,i){let s=ty(e.note);if(void 0!==s)for(let r of t.regions){let t=tk(s,null!=n?n:0,e,r,i);if(t)return t}}function tk(t,e,n,i,s){var r,o,l,a,u,h,p,c,d,f,m,y,g,P,v,_,M,b,D,w,F,A,k,S,I,E,C,G;if(!(t>=(null!=(r=i.midiLow)?r:0)&&t<(null!=(o=i.midiHigh)?o:127)+1)||!(void 0===n.velocity||n.velocity>=(null!=(l=i.velLow)?l:0)&&n.velocity<=(null!=(a=i.velHigh)?a:127))||i.seqLength&&e%i.seqLength!=(null!=(u=i.seqPosition)?u:1)-1)return;let B=t-i.midiPitch,N=null!=(h=n.velocity)?h:null==s?void 0:s.velocity,T=i.volume?Math.pow(10,i.volume/20):0,R=null!=(c=null!=(p=n.gainOffset)?p:null==s?void 0:s.gainOffset)?c:0,x=null!=(d=n.detune)?d:0;return{decayTime:null!=(y=null!=(m=null==n?void 0:n.decayTime)?m:null==(f=i.sample)?void 0:f.decayTime)?y:null==s?void 0:s.decayTime,detune:100*(B+(null!=(g=i.tune)?g:0))+x,duration:null!=(_=null!=(v=null==n?void 0:n.duration)?v:null==(P=i.sample)?void 0:P.duration)?_:null==s?void 0:s.duration,gainOffset:R+T||void 0,loop:null!=(D=null!=(b=null==n?void 0:n.loop)?b:null==(M=i.sample)?void 0:M.loop)?D:null==s?void 0:s.loop,loopEnd:null!=(A=null!=(F=null==n?void 0:n.loopEnd)?F:null==(w=i.sample)?void 0:w.loopEnd)?A:null==s?void 0:s.loopEnd,loopStart:null!=(I=null!=(S=null==n?void 0:n.loopStart)?S:null==(k=i.sample)?void 0:k.loopStart)?I:null==s?void 0:s.loopStart,lpfCutoffHz:null!=(G=null!=(C=null==n?void 0:n.lpfCutoffHz)?C:null==(E=i.sample)?void 0:E.lpfCutoffHz)?G:null==s?void 0:s.lpfCutoffHz,name:i.sampleName,note:t,onEnded:n.onEnded,onStart:n.onStart,stopId:n.name,time:n.time,velocity:void 0==N?void 0:N}}function tS(t){if(0===t.length)return[];if(t.sort((t,e)=>t.midiPitch-e.midiPitch),t[0].midiLow=0,t[0].midiHigh=127,1===t.length)return t;for(let e=1;e<t.length;e++){let n=t[e-1],i=t[e],s=Math.floor((n.midiPitch+i.midiPitch)/2);n.midiHigh=s,i.midiLow=s+1}return t[t.length-1].midiHigh=127,t}var tI=class{constructor(t,e){this.context=t,this.seqNum=0;let n=new tt(t,e);this.instrument=function(t={}){return{groups:[],options:t}}(e),this.player=new ti(new ts(t,H(U({},e),{destination:n.input})),e),this.output=n}get buffers(){return this.player.buffers}start(t){let e=[],n="object"==typeof t?t:{note:t};for(let t of this.instrument.groups){let i=tF(t,n,this.seqNum);for(let t of(this.seqNum++,i)){let n=this.player.start(t);e.push(n)}}return t=>e.forEach(e=>e(t))}stop(t){if(void 0==t){this.player.stop();return}let e="object"==typeof t?t:{stopId:t},n=ty(e.stopId);n&&(e.stopId=n,this.player.stop(e))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function tE(t,e){let n=ta();return(i,s)=>Z(this,null,function*(){let r=function(t,e){let n="global",i=t.split("\n").map(tT).filter(t=>!!t),s=new tR,r=[];for(let t of i)switch(t.type){case"mode":r.push(s.closeScope(n,e)),n=t.value;break;case"prop:num":case"prop:str":case"prop:num_arr":s.push(t.key,t.value);break;case"unknown":console.warn("Unknown SFZ token",t.value)}return r.filter(t=>!!t)}((yield fetch(t).then(t=>t.text())),e.group);r.length&&console.warn("Problems converting sfz",r);let o=new Set;return e.group.regions.forEach(t=>o.add(t.sampleName)),Promise.all(Array.from(o).map(t=>Z(this,null,function*(){let r=e.urlFromSampleName(t,n),o=yield to(i,r,s);e.buffers[t]=o}))).then(()=>e.group)})}var tC=/^<([^>]+)>$/,tG=/^([^=]+)=([-\.\d]+)$/,tB=/^([^=]+)=(.+)$/,tN=/^([^=]+)_(\d+)=(\d+)$/;function tT(t){if(""===(t=t.trim())||t.startsWith("//"))return;let e=t.match(tC);if(e)return{type:"mode",value:e[1]};let n=t.match(tN);if(n)return{type:"prop:num_arr",key:n[1],value:[Number(n[2]),Number(n[3])]};let i=t.match(tG);if(i)return{type:"prop:num",key:i[1],value:Number(i[2])};let s=t.match(tB);return s?{type:"prop:str",key:s[1],value:s[2]}:{type:"unknown",value:t}}var tR=class{constructor(){q(this,A),this.values={},this.global={},this.group={}}closeScope(t,e){if("global"===t)K(this,A,k).call(this,this.global);else if("group"===t)this.group=K(this,A,k).call(this,{});else if("region"===t){let t=K(this,A,k).call(this,U(U({sampleName:"",midiPitch:-1},this.global),this.group));if(""===t.sampleName)return"Missing sample name";if(-1===t.midiPitch){if(void 0===t.midiLow)return"Missing pitch_keycenter";t.midiPitch=t.midiLow}t.seqLength&&void 0===t.seqPosition&&(t.seqPosition=1),t.ampRelease&&(t.sample={decayTime:t.ampRelease},delete t.ampRelease),e.regions.push(t)}}get empty(){return 0===Object.keys(this.values).length}get keys(){return Object.keys(this.values)}push(t,e){this.values[t]=e}popNum(t,e,n){return"number"==typeof this.values[t]&&(e[n]=this.values[t],delete this.values[t],!0)}popStr(t,e,n){return"string"==typeof this.values[t]&&(e[n]=this.values[t],delete this.values[t],!0)}popNumArr(t,e,n){return!!Array.isArray(this.values[t])&&(e[n]=this.values[t],delete this.values[t],!0)}};A=new WeakSet,k=function(t){return this.popStr("sample",t,"sampleName"),this.popNum("pitch_keycenter",t,"midiPitch"),this.popNum("ampeg_attack",t,"ampAttack"),this.popNum("ampeg_release",t,"ampRelease"),this.popNum("bend_down",t,"bendDown"),this.popNum("bend_up",t,"bendUp"),this.popNum("group",t,"group"),this.popNum("hikey",t,"midiHigh"),this.popNum("hivel",t,"velHigh"),this.popNum("lokey",t,"midiLow"),this.popNum("offset",t,"offset"),this.popNum("lovel",t,"velLow"),this.popNum("off_by",t,"groupOffBy"),this.popNum("pitch_keytrack",t,"ignore"),this.popNum("seq_length",t,"seqLength"),this.popNum("seq_position",t,"seqPosition"),this.popNum("tune",t,"tune"),this.popNum("volume",t,"volume"),this.popNumArr("amp_velcurve",t,"ampVelCurve"),this.values={},t};var tx=[],tO="https://smpldsnds.github.io/sgossner-vcsl/";function tL(){return Z(this,null,function*(){return tx.length?tx:tx=yield fetch(tO+"sfz_files.json").then(t=>t.json())})}var tj=class{constructor(t,e={}){var n,i;this.config={instrument:null!=(n=e.instrument)?n:"Arco",storage:null!=(i=e.storage)?i:tu},this.player=new tI(t,e);let s=function(t,e){let n=t.slice(0,t.lastIndexOf("/")+1),i=`https://smpldsnds.github.io/sgossner-vcsl/${n}`;return tE(tO+t+".sfz",{buffers:e,group:tw(),urlFromSampleName:(t,e)=>i+"/"+t.replace(".wav",e)})}(this.config.instrument,this.player.buffers);this.load=s(t,this.config.storage).then(t=>(this.player.instrument.groups.push(t),this))}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){return this.player.start(t)}stop(t){return this.player.stop(t)}disconnect(){this.player.disconnect()}};function tW(){return Object.keys(tU)}var tz=class extends tj{constructor(t,e){var n;super(t,H(U({},e),{instrument:tU[null!=(n=e.instrument)?n:""]}))}},tU={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"},tH={"300 STRINGS CELLO":["300 STRINGS","CELL"],"300 STRINGS VIOLA":["300 STRINGS","VIOL"]};function tV(){return["300 STRINGS CELLO","300 STRINGS VIOLA","8VOICE CHOIR","BASSA+STRNGS","BOYS CHOIR","CHA CHA FLT","CHM CLARINET","CHMB 3 VLNS","CHMB ALTOSAX","CHMB FEMALE","CHMB MALE VC","CHMB TNR SAX","CHMB TRMBONE","CHMB TRUMPET","CHMBLN CELLO","CHMBLN FLUTE","CHMBLN OBOE","DIXIE+TRMBN","FOXTROT+SAX","HALFSP.BRASS","MIXED STRGS","MKII BRASS","MKII GUITAR","MKII ORGAN","MKII SAX","MKII VIBES","MKII VIOLINS","MOVE BS+STGS","STRGS+BRASS","TROMB+TRMPT","TRON 16VLNS","TRON CELLO","TRON FLUTE","TRON VIOLA"]}var t$=class{constructor(t,e){var n,i,s,r,o;let l;this.context=t,this.options=e,this.config={instrument:null!=(n=e.instrument)?n:"MKII VIOLINS",storage:null!=(i=e.storage)?i:tu},this.player=new tr(t,e),this.group=tw();let a=(s=this.config.instrument,r=this.player.buffers,o=this.group,(l=tH[s])&&(s=l[0]),(t,e)=>{let n=`https://smpldsnds.github.io/archiveorg-mellotron/${s}/`,i=ta();return fetch(n+"files.json").then(t=>t.json()).then(s=>Promise.all(s.map(s=>{var a;if(l&&!s.includes(l[1]))return;let u=ty(null!=(a=s.split(" ")[0])?a:"");u&&to(t,n+s+i,e).then(t=>{var e;r[s]=t;let n=null!=(e=null==t?void 0:t.duration)?e:0;o.regions.push({sampleName:s,midiPitch:u,sample:{loop:!0,loopStart:n/10,loopEnd:n-n/10}})})}))).then(()=>{tS(o.regions)})});this.load=a(t,this.config.storage).then(()=>this)}get buffers(){return this.player.buffers}get output(){return this.player.output}start(t){let e=tA(this.group,"object"==typeof t?t:{note:t},void 0,this.options);return e?this.player.start(e):()=>void 0}stop(t){this.player.stop(t)}disconnect(){this.player.disconnect()}},tq=["preDelay","bandwidth","inputDiffusion1","inputDiffusion2","decay","decayDiffusion1","decayDiffusion2","damping","excursionRate","excursionDepth","wet","dry"],tX=new WeakMap,tK=class{constructor(t){q(this,S,void 0),q(this,I,void 0),q(this,E,void 0),this.input=t.createGain(),X(this,E,t.destination),X(this,I,(function(t){return Z(this,null,function*(){let e=tX.get(t);if(!e){let n=new Blob(['"use strict";(()=>{var f=class extends AudioWorkletProcessor{_pDLength;_preDelay;_pDWrite;_lp1;_lp2;_lp3;_excPhase;_taps;_Delays;sampleRate;static get parameterDescriptors(){return[["preDelay",0,0,sampleRate-1,"k-rate"],["bandwidth",.9999,0,1,"k-rate"],["inputDiffusion1",.75,0,1,"k-rate"],["inputDiffusion2",.625,0,1,"k-rate"],["decay",.5,0,1,"k-rate"],["decayDiffusion1",.7,0,.999999,"k-rate"],["decayDiffusion2",.5,0,.999999,"k-rate"],["damping",.005,0,1,"k-rate"],["excursionRate",.5,0,2,"k-rate"],["excursionDepth",.7,0,2,"k-rate"],["wet",1,0,1,"k-rate"],["dry",0,0,1,"k-rate"]].map(e=>new Object({name:e[0],defaultValue:e[1],minValue:e[2],maxValue:e[3],automationRate:e[4]}))}constructor(e){super(),this.sampleRate=sampleRate,this._Delays=[],this._pDLength=sampleRate+(128-sampleRate%128),this._preDelay=new Float32Array(this._pDLength),this._pDWrite=0,this._lp1=0,this._lp2=0,this._lp3=0,this._excPhase=0,[.004771345,.003595309,.012734787,.009307483,.022579886,.149625349,.060481839,.1249958,.030509727,.141695508,.089244313,.106280031].forEach(a=>this.makeDelay(a,sampleRate)),this._taps=Int16Array.from([.008937872,.099929438,.064278754,.067067639,.066866033,.006283391,.035818689,.011861161,.121870905,.041262054,.08981553,.070931756,.011256342,.004065724],a=>Math.round(a*sampleRate))}makeDelay(e,a){let t=Math.round(e*a),s=2**Math.ceil(Math.log2(t));this._Delays.push([new Float32Array(s),t-1,0,s-1])}writeDelay(e,a){return this._Delays[e][0][this._Delays[e][1]]=a}readDelay(e){return this._Delays[e][0][this._Delays[e][2]]}readDelayAt(e,a){let t=this._Delays[e];return t[0][t[2]+a&t[3]]}readDelayCAt(e,a){let t=this._Delays[e],s=a-~~a,d=~~a+t[2]-1,r=t[3],D=t[0][d++&r],l=t[0][d++&r],h=t[0][d++&r],y=t[0][d&r],u=(3*(l-h)-D+y)/2,m=2*h+D-(5*l+y)/2,c=(h-D)/2;return((u*s+m)*s+c)*s+l}process(e,a,t){let s=~~t.preDelay[0],d=t.bandwidth[0],r=t.inputDiffusion1[0],D=t.inputDiffusion2[0],l=t.decay[0],h=t.decayDiffusion1[0],y=t.decayDiffusion2[0],u=1-t.damping[0],m=t.excursionRate[0]/sampleRate,c=t.excursionDepth[0]*sampleRate/1e3,w=t.wet[0]*.6,A=t.dry[0];if(e[0].length==2)for(let i=127;i>=0;i--)this._preDelay[this._pDWrite+i]=(e[0][0][i]+e[0][1][i])*.5,a[0][0][i]=e[0][0][i]*A,a[0][1][i]=e[0][1][i]*A;else if(e[0].length>0){this._preDelay.set(e[0][0],this._pDWrite);for(let i=127;i>=0;i--)a[0][0][i]=a[0][1][i]=e[0][0][i]*A}else this._preDelay.set(new Float32Array(128),this._pDWrite);let o=0;for(;o<128;){let i=0,b=0;this._lp1+=d*(this._preDelay[(this._pDLength+this._pDWrite-s+o)%this._pDLength]-this._lp1);let p=this.writeDelay(0,this._lp1-r*this.readDelay(0));p=this.writeDelay(1,r*(p-this.readDelay(1))+this.readDelay(0)),p=this.writeDelay(2,r*p+this.readDelay(1)-D*this.readDelay(2)),p=this.writeDelay(3,D*(p-this.readDelay(3))+this.readDelay(2));let k=D*p+this.readDelay(3),g=c*(1+Math.cos(this._excPhase*6.28)),x=c*(1+Math.sin(this._excPhase*6.2847)),_=this.writeDelay(4,k+l*this.readDelay(11)+h*this.readDelayCAt(4,g));this.writeDelay(5,this.readDelayCAt(4,g)-h*_),this._lp2+=u*(this.readDelay(5)-this._lp2),_=this.writeDelay(6,l*this._lp2-y*this.readDelay(6)),this.writeDelay(7,this.readDelay(6)+y*_),_=this.writeDelay(8,k+l*this.readDelay(7)+h*this.readDelayCAt(8,x)),this.writeDelay(9,this.readDelayCAt(8,x)-h*_),this._lp3+=u*(this.readDelay(9)-this._lp3),_=this.writeDelay(10,l*this._lp3-y*this.readDelay(10)),this.writeDelay(11,this.readDelay(10)+y*_),i=this.readDelayAt(9,this._taps[0])+this.readDelayAt(9,this._taps[1])-this.readDelayAt(10,this._taps[2])+this.readDelayAt(11,this._taps[3])-this.readDelayAt(5,this._taps[4])-this.readDelayAt(6,this._taps[5])-this.readDelayAt(7,this._taps[6]),b=this.readDelayAt(5,this._taps[7])+this.readDelayAt(5,this._taps[8])-this.readDelayAt(6,this._taps[9])+this.readDelayAt(7,this._taps[10])-this.readDelayAt(9,this._taps[11])-this.readDelayAt(10,this._taps[12])-this.readDelayAt(11,this._taps[13]),a[0][0][o]+=i*w,a[0][1][o]+=b*w,this._excPhase+=m,o++;for(let R=0,n=this._Delays[0];R<this._Delays.length;n=this._Delays[++R])n[1]=n[1]+1&n[3],n[2]=n[2]+1&n[3]}return this._pDWrite=(this._pDWrite+128)%this._pDLength,!0}};registerProcessor("DattorroReverb",f);})();'],{type:"application/javascript"}),i=URL.createObjectURL(n);e=t.audioWorklet.addModule(i),tX.set(t,e)}return yield e,new AudioWorkletNode(t,"DattorroReverb",{outputChannelCount:[2]})})})(t).then(t=>(this.input.connect(t),t.connect($(this,E)),X(this,S,t),this)))}get paramNames(){return tq}getParam(t){var e;return null==(e=$(this,S))?void 0:e.parameters.get("preDelay")}get isReady(){return void 0!==$(this,S)}ready(){return $(this,I)}connect(t){$(this,S)&&($(this,S).disconnect($(this,E)),$(this,S).connect(t)),X(this,E,t)}};S=new WeakMap,I=new WeakMap,E=new WeakMap;var tZ=class{constructor(t,e={}){var n,i,s,r,o,l;this.context=t,q(this,C,void 0),X(this,C,{destination:null!=(n=e.destination)?n:t.destination,detune:0,volume:null!=(i=e.volume)?i:100,velocity:null!=(s=e.velocity)?s:100,buffers:null!=(r=e.buffers)?r:{},volumeToGain:null!=(o=e.volumeToGain)?o:Q}),this.player=new tr(t,$(this,C));let a=null!=(l=e.storage)?l:tu,u="function"==typeof $(this,C).buffers?$(this,C).buffers:function(t,e){return(n,i)=>Z(this,null,function*(){yield Promise.all([Object.keys(t).map(s=>Z(this,null,function*(){let r=t[s];if(r instanceof AudioBuffer)i[s]=r;else if("string"==typeof r){let t=yield to(n,r,e);t&&(i[s]=t)}}))])})}($(this,C).buffers,a);this.load=u(t,this.player.buffers).then(()=>this)}loaded(){return Z(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get output(){return this.player.output}start(t){return this.player.start("object"==typeof t?t:{note:t})}stop(t){return this.player.stop("object"==typeof t?t:void 0===t?void 0:{stopId:t})}disconnect(){return this.player.disconnect()}};function tJ(){return["Pizzicato","Arco","Switched"]}C=new WeakMap;var tY=class{constructor(t,e={}){var n,i,s;this.seqNum=0,this.config={instrument:null!=(n=e.instrument)?n:"Arco",storage:null!=(i=e.storage)?i:tu},this.player=new tr(t,e),this.group=tw();let r=tE((s=this.config.instrument,`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${({Arco:"arco",Pizzicato:"pizz",Switched:"switched"})[s]}.sfz`),{buffers:this.player.buffers,group:this.group,urlFromSampleName:(t,e)=>{let n=t.replace("\\","/").replace(".wav",e);return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${n}`}});this.load=r(t,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){let e=tF(this.group,"object"==typeof t?t:{note:t},this.seqNum);this.seqNum++;let n=e.map(t=>this.player.start(t));return t=>n.forEach(e=>e(t))}stop(t){if(void 0==t){this.player.stop();return}let e="object"==typeof t?t:{stopId:t},n=ty(e.stopId);n&&(e.stopId=n,this.player.stop(e))}disconnect(){this.player.disconnect()}},tQ=["MusyngKite","FluidR3_GM"],t0=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function t1(){return tQ}function t2(){return t0}var t5=class{constructor(t,e){this.context=t,q(this,G,void 0),this.config=function(t){var e,n,i,s;if(!t.instrument&&!t.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");let r={kit:"MusyngKite",instrument:t.instrument,storage:null!=(e=t.storage)?e:tu,extraGain:null!=(n=t.extraGain)?n:5,loadLoopData:null!=(i=t.loadLoopData)&&i,loopDataUrl:t.loopDataUrl,instrumentUrl:null!=(s=t.instrumentUrl)?s:""};return r.instrument&&r.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),r.instrumentUrl=r.instrument,r.instrument=void 0),r.instrument&&!r.instrumentUrl&&(r.instrumentUrl=function(t,e){var n;let i=null!=(n=tl(["ogg","mp3"]))?n:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${e}/${t}-${i}.js`}(r.instrument,r.kit)),r.loadLoopData&&r.instrument&&!r.loopDataUrl&&(r.loopDataUrl=function(t,e){if(!t.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${e}/${t}-loop.json`}(r.instrument,r.kit)),r}(e),this.player=new tr(t,e),this.group=tw(),X(this,G,!1);let n=function(t,e,n,i){let s=function(t,e,n){return(i,s)=>Z(this,null,function*(){let r=function(t){let e=t.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");let n=t.indexOf("=",e)+2,i=t.lastIndexOf(",");return JSON.parse(t.slice(n,i)+"}")}((yield(yield s.fetch(t)).text())),o=Object.keys(r);yield Promise.all(o.map(t=>Z(this,null,function*(){var s;let o=ty(t);if(!o)return;let l=function(t){let e=window.atob(t),n=e.length,i=new Uint8Array(n);for(let t=0;t<n;t++)i[t]=e.charCodeAt(t);return i.buffer}((s=r[t]).slice(s.indexOf(",")+1)),a=yield i.decodeAudioData(l);e[t]=a,n.regions.push({sampleName:t,midiPitch:o})}))),tS(n.regions)})}(t,n,i);return(t,n)=>Z(this,null,function*(){let[r,o]=yield Promise.all([s(t,n),function(t,e=44100){return Z(this,null,function*(){if(t)try{let n=yield fetch(t);if(200!==n.status)return;let i=yield n.json(),s={};return Object.keys(i).forEach(t=>{let n=ty(t);if(n){let r=i[t];s[n]=[r[0]/e,r[1]/e]}}),s}catch(t){return}})}(e)]);return o&&i.regions.forEach(t=>{let e=o[t.midiPitch];e&&(null!=t.sample||(t.sample={}),t.sample.loop=!0,t.sample.loopStart=e[0],t.sample.loopEnd=e[1])}),!!o})}(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=n(t,this.config.storage).then(t=>(X(this,G,t),this));let i=t.createGain();i.gain.value=this.config.extraGain,this.player.output.addInsert(i)}get output(){return this.player.output}get hasLoops(){return $(this,G)}loaded(){return Z(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(t){let e=tA(this.group,"object"==typeof t?t:{note:t});return e?this.player.start(e):()=>void 0}stop(t){return this.player.stop(t)}};G=new WeakMap;var t3=class{constructor(t,e){this.context=t,this.options=e,q(this,B,[]),this.player=new tI(t,e),this.load=(function(t){return Z(this,null,function*(){let e=yield fetch(t.url).then(t=>t.arrayBuffer()),n=new Uint8Array(e);return t.createSoundfont(n)})})(e).then(t=>{this.soundfont=t,X(this,B,t.instruments.map(t=>t.header.name))}).then(()=>this)}get instrumentNames(){return $(this,B)}loadInstrument(t){var e,n,i;let s=null==(e=this.soundfont)?void 0:e.instruments.find(e=>e.header.name===t);if(!s)return;let r=this.player.buffers,o={regions:[]};for(let t of s.zones){let e=t.sample,s=e.header,l=function(t,e){let{header:n,data:i}=e,s=new Float32Array(i.length);for(let t=0;t<i.length;t++)s[t]=i[t]/32768;let r=t.createBuffer(1,s.length,n.sampleRate);return r.getChannelData(0).set(s),r}(this.context,e),a={sampleName:e.header.name,midiPitch:e.header.originalPitch,midiLow:null==(n=t.keyRange)?void 0:n.lo,midiHigh:null==(i=t.keyRange)?void 0:i.hi,sample:{loop:s.startLoop>=0&&s.endLoop>s.startLoop,loopStart:s.startLoop/s.sampleRate,loopEnd:s.endLoop/s.sampleRate}};o.regions.push(a),r[a.sampleName]=l}let l={groups:[o],options:this.options};return this.player.instrument=l,[l,r]}get output(){return this.player.output}start(t){return this.player.start(t)}stop(t){return this.player.stop(t)}disconnect(){this.player.disconnect()}};B=new WeakMap;var t6=class{constructor(t,e){this.context=t,q(this,N),this.options=Object.assign({baseUrl:"https://danigb.github.io/samples/splendid-grand-piano",storage:tu,detune:0,volume:100,velocity:100,decayTime:.5},e),this.player=new tr(t,this.options);let n=function(t,e,n){var i;let s=null!=(i=tl(["ogg","m4a"]))?i:"ogg",r=n?t4.filter(t=>t.vel_range[0]<=n.velocityRange[1]&&t.vel_range[1]>=n.velocityRange[0]):t4;return(i,o)=>Z(this,null,function*(){for(let l of r){let r=n?l.samples.filter(t=>n.notes.includes(t[0])):l.samples;yield Promise.all(r.map(n=>Z(this,[n],function*([n,r]){let a=`${t}/${r}.${s}`,u=yield to(i,a,e);u&&(o[l.name+n]=u)})))}})}(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=n(t,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return Z(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(t){var e,n;let i="object"==typeof t?U({},t):{note:t},s=K(this,N,T).call(this,i);return s?(i.note=s[0],i.stopId=null!=(e=i.stopId)?e:s[1],i.detune=s[2]+(null!=(n=i.detune)?n:this.options.detune),this.player.start(i)):()=>void 0}stop(t){return this.player.stop(t)}};N=new WeakSet,T=function(t){var e;let n=ty(t.note);if(!n)return;let i=null!=(e=t.velocity)?e:this.options.velocity,s=t4.findIndex(t=>i>=t.vel_range[0]&&i<=t.vel_range[1]),r=t4[s];if(r)return function(t,e,n){let i=0;for(;void 0===n[t+(e+i)]&&i<128;)i=i>0?-i:-i+1;return 127===i?[t+e,e,0]:[t+(e+i),e,-(100*i)]}(r.name,n,this.player.buffers)};var t4=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}]}}]);